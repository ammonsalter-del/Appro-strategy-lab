<!DOCTYPE html>
<!--
  Appropriation Strategy Lab
  ===========================
  ¬© 2025 Ammon Salter
  
  Licensed under the Creative Commons Attribution-NonCommercial-ShareAlike 4.0 
  International License (CC BY-NC-SA 4.0).
  
  You are free to:
    - Share: copy and redistribute the material in any medium or format
    - Adapt: remix, transform, and build upon the material
  
  Under the following terms:
    - Attribution: You must give appropriate credit to Ammon Salter
    - NonCommercial: You may not use the material for commercial purposes
    - ShareAlike: If you remix or transform, you must distribute under the same license
  
  Full license: https://creativecommons.org/licenses/by-nc-sa/4.0/
  
  Contributors: Federico Bignone, Paola Criscuolo, Almantas Palubinskas
  
  Built with AI assistance: Claude, Gemini, GPT-5
  
  Based on the framework from:
  Teece, D.J. (1986). "Profiting from technological innovation"
-->
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Appropriation Strategy Lab</title>
  
  <!-- Google Analytics ‚Äî GDPR opt-in consent -->
  <script>
    // GA only loads after explicit consent (opt-in, not opt-out)
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    window.gaConsent = localStorage.getItem('ga_consent');  // 'accepted', 'declined', or null

    function loadGA() {
      if (window.gaLoaded) return;
      window.gaLoaded = true;
      var s = document.createElement('script');
      s.async = true;
      s.src = 'https://www.googletagmanager.com/gtag/js?id=G-QSV9NQJD56';
      document.head.appendChild(s);
      gtag('js', new Date());
      gtag('config', 'G-QSV9NQJD56', { anonymize_ip: true });
    }

    // If user previously accepted, load GA immediately
    if (window.gaConsent === 'accepted') {
      loadGA();
    }

    function acceptCookies() {
      localStorage.setItem('ga_consent', 'accepted');
      window.gaConsent = 'accepted';
      loadGA();
      hideCookieBanner();
      updateConsentLinks();
    }

    function declineCookies() {
      localStorage.setItem('ga_consent', 'declined');
      window.gaConsent = 'declined';
      window['ga-disable-G-QSV9NQJD56'] = true;
      hideCookieBanner();
      updateConsentLinks();
    }

    function hideCookieBanner() {
      var banner = document.getElementById('cookie-banner');
      if (banner) banner.style.display = 'none';
    }

    function changeConsentPreference() {
      localStorage.removeItem('ga_consent');
      window.gaConsent = null;
      window['ga-disable-G-QSV9NQJD56'] = true;
      var banner = document.getElementById('cookie-banner');
      if (banner) banner.style.display = 'block';
      updateConsentLinks();
    }

    function updateConsentLinks() {
      var status = window.gaConsent;
      document.querySelectorAll('.ga-consent-status').forEach(function(el) {
        if (status === 'accepted') el.textContent = 'Cookies accepted.';
        else if (status === 'declined') el.textContent = 'Cookies declined.';
        else el.textContent = '';
      });
      document.querySelectorAll('.ga-consent-change').forEach(function(el) {
        el.style.display = (status === 'accepted' || status === 'declined') ? 'inline' : 'none';
      });
    }
  </script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      color-scheme: light;
    }
    * {
      box-sizing: border-box;
    }
    /* Cookie consent banner */
    #cookie-banner {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: #1f2937;
      color: #e5e7eb;
      padding: 1rem 1.5rem;
      z-index: 9999;
      font-size: 0.85rem;
      line-height: 1.5;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 0.75rem 1.5rem;
      box-shadow: 0 -4px 20px rgba(0,0,0,0.3);
    }
    #cookie-banner p {
      margin: 0;
      flex: 1 1 300px;
    }
    #cookie-banner .cookie-btns {
      display: flex;
      gap: 0.5rem;
      flex-shrink: 0;
    }
    #cookie-banner button {
      padding: 0.4rem 1rem;
      border-radius: 0.4rem;
      border: none;
      font-size: 0.8rem;
      font-weight: 600;
      cursor: pointer;
    }
    #cookie-banner .cookie-accept {
      background: #22c55e;
      color: white;
    }
    #cookie-banner .cookie-decline {
      background: transparent;
      color: #9ca3af;
      border: 1px solid #4b5563;
    }
    #cookie-banner .cookie-decline:hover {
      background: rgba(255,255,255,0.05);
    }
    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle at top, #22c55e 0, #0f172a 45%, #020617 100%);
      font-size: 17px; /* larger base font */
    }
    #game-root {
      max-width: 1100px;
      width: 100%;
      margin: 1rem;
      background: #f9fafb;
      color: #111827;
      border-radius: 1.5rem;
      padding: 1.9rem 1.4rem 2.1rem;
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.45);
      border: 1px solid #e5e7eb;
    }
    @media (min-width: 900px) {
      #game-root {
        padding: 2.2rem 2.4rem 2.6rem;
      }
    }
    h1 {
      margin: 0 0 0.6rem;
      font-size: 2rem;
      letter-spacing: 0.02em;
    }
    .subtitle {
      margin: 0 0 1.2rem;
      font-size: 1rem;
      color: #4b5563;
    }
    #stats-bar {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      font-size: 0.98rem;
      margin-bottom: 1.1rem;
    }
    .stat-pill {
      padding: 0.45rem 0.95rem;
      border-radius: 999px;
      border: 1px solid #e5e7eb;
      background: #ffffff;
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }
    .stat-label {
      font-weight: 600;
    }
    .muted {
      opacity: 0.75;
      font-weight: 400;
    }
    #layout {
      display: grid;
      gap: 1.3rem;
    }
    @media (min-width: 960px) {
      #layout {
        grid-template-columns: 3fr 2.5fr;
      }
    }
    #scenario-card,
    #result-card {
      background: #ffffff;
      border-radius: 1rem;
      padding: 1.3rem 1.15rem 1.5rem;
      border: 1px solid #e5e7eb;
    }
    #scenario-title {
      margin: 0 0 0.4rem;
      font-size: 1.3rem;
      font-weight: 700;
      color: #111827;
    }
    #scenario-what {
      margin: 0 0 0.3rem;
      font-size: 1.02rem;
      color: #111827;
      font-weight: 500;
    }
    #scenario-description {
      margin: 0 0 0.7rem;
      font-size: 0.96rem;
      color: #374151;
    }
    #key-facts {
      list-style: none;
      padding: 0;
      margin: 0 0 0.9rem;
      font-size: 0.92rem;
      color: #4b5563;
    }
    #key-facts li {
      margin-bottom: 0.25rem;
    }
    #key-facts span.fact-label {
      font-weight: 600;
      color: #111827;
      margin-right: 0.25rem;
    }
    #choices-label {
      font-size: 0.9rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #6b7280;
      margin-bottom: 0.5rem;
    }
    #choices {
      display: flex;
      flex-direction: column;
      gap: 0.6rem;
    }
    .choice-btn {
      border-radius: 0.9rem;
      border: 1px solid #e5e7eb;
      background: #f9fafb;
      padding: 0.7rem 0.95rem;
      font-size: 0.94rem;
      text-align: left;
      cursor: pointer;
      transition: transform 0.08s ease-out, box-shadow 0.08s ease-out,
        border-color 0.08s ease-out, background 0.08s ease-out;
      display: flex;
      flex-direction: column;
      gap: 0.18rem;
    }
    .choice-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 14px rgba(15, 23, 42, 0.08);
      border-color: #22c55e;
      background: #ffffff;
    }
    .choice-btn.selected {
      border-color: #22c55e;
      box-shadow: 0 0 0 1px rgba(34, 197, 94, 0.35);
      background: linear-gradient(135deg, #ecfdf3, #f9fafb);
    }
    .choice-main {
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.35rem;
      color: #111827;
    }
    .choice-key {
      font-size: 0.8rem;
      text-transform: uppercase;
      padding: 0.05rem 0.5rem;
      border-radius: 999px;
      border: 1px solid #d1d5db;
      opacity: 0.9;
      background: #f3f4f6;
    }
    .choice-tools {
      font-size: 0.8rem;
      color: #4f46e5;
    }
    .choice-meta {
      font-size: 0.84rem;
      color: #4b5563;
    }
    #result-card h2 {
      margin: 0 0 0.4rem;
      font-size: 1.1rem;
      color: #111827;
    }
    #result-heading {
      font-weight: 700;
      margin-bottom: 0.45rem;
      font-size: 1rem;
      color: #111827;
    }
    #result-heading.negative {
      color: #b91c1c;
    }
    #result-text {
      font-size: 0.96rem;
      margin: 0 0 0.65rem;
      color: #374151;
    }
    #result-metrics {
      font-size: 0.88rem;
      margin: 0 0 0.45rem;
      color: #4b5563;
      line-height: 1.5;
    }
    #profit-text {
      font-size: 0.94rem;
      margin: 0 0 0.45rem;
      color: #111827;
      font-weight: 500;
    }
    #concept-link {
      font-size: 0.88rem;
      color: #4b5563;
      margin-top: 0.3rem;
    }
    #concept-link span {
      font-weight: 600;
      color: #111827;
    }
    #next-row {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      margin-top: 1rem;
      font-size: 0.86rem;
      color: #6b7280;
    }
    @media (min-width: 640px) {
      #next-row {
        flex-direction: row;
        align-items: center;
        justify-content: space-between;
      }
    }
    #next-btn {
      border-radius: 999px;
      border: none;
      padding: 0.7rem 1.4rem;
      font-size: 0.96rem;
      cursor: pointer;
      background: linear-gradient(135deg, #22c55e, #16a34a);
      color: white;
      font-weight: 600;
      box-shadow: 0 8px 18px rgba(22, 163, 74, 0.35);
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      transition: transform 0.08s ease-out, box-shadow 0.08s ease-out,
        filter 0.08s ease-out;
      white-space: nowrap;
      align-self: flex-end;
    }
    #next-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 12px 24px rgba(22, 163, 74, 0.5);
      filter: brightness(1.03);
    }
    #next-btn:disabled {
      cursor: not-allowed;
      opacity: 0.5;
      box-shadow: none;
      transform: none;
    }
    #legend {
      margin-top: 1.2rem;
      font-size: 0.88rem;
      color: #4b5563;
      border-top: 1px dashed #d1d5db;
      padding-top: 0.85rem;
    }
    #legend strong {
      color: #111827;
      font-weight: 700;
    }
    .badge {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.1rem 0.55rem;
      border-radius: 999px;
      font-size: 0.8rem;
      border: 1px solid #d1d5db;
      margin-right: 0.25rem;
      margin-bottom: 0.1rem;
      background: #f9fafb;
      gap: 0.15rem;
    }
    .badge-patent { border-color: #4f46e5; }
    .badge-mark { border-color: #f97316; }
    .badge-copyright { border-color: #ec4899; }
    .badge-secret { border-color: #22c55e; }
    .badge-speed { border-color: #38bdf8; }
    .badge-complexity { border-color: #a855f7; }
    .badge-community { border-color: #eab308; }
    .badge-asset { border-color: #0ea5e9; }
    .badge-contract { border-color: #6366f1; }
    .info-icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 1.05rem;
      height: 1.05rem;
      border-radius: 999px;
      border: 1px solid #9ca3af;
      font-size: 0.75rem;
      background: #e5e7eb;
      color: #111827;
      cursor: pointer;
    }
    .info-icon:hover {
      background: #d1d5db;
    }
    /* Expandable info panels */
    .info-section {
      margin-top: 1.1rem;
      border-top: 1px dashed #d1d5db;
      padding-top: 0.8rem;
      font-size: 0.9rem;
    }
    .info-title {
      font-weight: 700;
      cursor: pointer;
      color: #1e3a8a;
      margin: 0.4rem 0;
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }
    .info-title:hover {
      text-decoration: underline;
    }
    .info-content {
      display: none;
      margin: 0.4rem 0 1rem;
      padding: 0.7rem 0.9rem;
      border-left: 3px solid #94a3b8;
      background: #f1f5f9;
      border-radius: 0.25rem;
      font-size: 0.88rem;
      color: #374151;
    }
    /* Summary "animal" label */
    .rank-label {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      padding: 0.4rem 0.9rem;
      border-radius: 999px;
      background: #ecfdf3;
      color: #166534;
      font-weight: 700;
      font-size: 1.05rem;
      margin-bottom: 0.5rem;
    }
    /* Summary Mode Enhancements */
    body.summary-mode #scenario-card {
      display: none;
    }
    body.summary-mode #layout {
      grid-template-columns: 1fr;
    }
    body.summary-mode #result-card {
      grid-column: 1 / -1;
      padding: 2rem 1.6rem 2.1rem;
    }
    body.summary-mode #result-card h2 {
      font-size: 1.35rem;
    }
    body.summary-mode #result-heading {
      font-size: 1.15rem;
    }
    body.summary-mode #result-text {
      font-size: 1.02rem;
    }
    body.summary-mode #result-metrics,
    body.summary-mode #profit-text,
    body.summary-mode #concept-link {
      font-size: 0.97rem;
    }
    #learning-focus {
        margin-top: 1.5rem;
        padding: 0.8rem 1rem;
        border: 1px solid #d1d5db;
        border-radius: 0.5rem;
        background: #fffbef; /* Light yellow background for focus section */
    }
    #learning-focus h3 {
        margin: 0 0 0.5rem;
        font-size: 1.1rem;
        color: #92400e; /* Darker color for focus heading */
    }
    #learning-focus p {
        margin: 0;
        font-size: 0.95rem;
        color: #44403c;
        line-height: 1.5;
    }
    #concept-summary {
      margin-top: 1.5rem;
      padding-top: 1rem;
      border-top: 1px solid #e5e7eb;
    }
    #concept-summary h3 {
      margin: 0 0 0.8rem;
      font-size: 1.1rem;
      color: #111827;
    }
    #concept-summary ul {
      list-style-type: 'üß† ';
      padding-left: 1.5rem;
      margin: 0;
      font-size: 0.9rem;
      line-height: 1.6;
      color: #374151;
    }
    /* Enhanced End Screen Styles */
    .encouragement-banner {
      background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
      border: 1px solid #a7f3d0;
      border-radius: 1rem;
      padding: 1.2rem 1.4rem;
      margin-bottom: 1.2rem;
      text-align: center;
    }
    .encouragement-banner.rank-low {
      background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
      border-color: #fcd34d;
    }
    .encouragement-banner h3 {
      margin: 0 0 0.5rem;
      font-size: 1.2rem;
      color: #065f46;
    }
    .encouragement-banner.rank-low h3 {
      color: #92400e;
    }
    .encouragement-banner p {
      margin: 0;
      font-size: 0.95rem;
      color: #047857;
      line-height: 1.5;
    }
    .encouragement-banner.rank-low p {
      color: #a16207;
    }
    .strengths-section {
      background: #f0fdf4;
      border: 1px solid #bbf7d0;
      border-radius: 0.75rem;
      padding: 1rem 1.2rem;
      margin-bottom: 1rem;
    }
    .strengths-section h4 {
      margin: 0 0 0.6rem;
      font-size: 1rem;
      color: #166534;
      display: flex;
      align-items: center;
      gap: 0.4rem;
    }
    .strengths-section ul {
      margin: 0;
      padding-left: 1.2rem;
      font-size: 0.9rem;
      color: #15803d;
    }
    .strengths-section li {
      margin-bottom: 0.3rem;
    }
    .growth-section {
      background: #fffbeb;
      border: 1px solid #fde68a;
      border-radius: 0.75rem;
      padding: 1rem 1.2rem;
      margin-bottom: 1rem;
    }
    .growth-section h4 {
      margin: 0 0 0.6rem;
      font-size: 1rem;
      color: #92400e;
      display: flex;
      align-items: center;
      gap: 0.4rem;
    }
    .growth-section p {
      margin: 0 0 0.5rem;
      font-size: 0.9rem;
      color: #a16207;
      line-height: 1.5;
    }
    .growth-section p:last-child {
      margin-bottom: 0;
    }
    .tips-section {
      background: #eff6ff;
      border: 1px solid #bfdbfe;
      border-radius: 0.75rem;
      padding: 1rem 1.2rem;
      margin-bottom: 1rem;
    }
    .tips-section h4 {
      margin: 0 0 0.6rem;
      font-size: 1rem;
      color: #1e40af;
      display: flex;
      align-items: center;
      gap: 0.4rem;
    }
    .tips-section ul {
      margin: 0;
      padding-left: 1.2rem;
      font-size: 0.9rem;
      color: #1e3a8a;
    }
    .tips-section li {
      margin-bottom: 0.4rem;
      line-height: 1.4;
    }
    .replay-encouragement {
      background: linear-gradient(135deg, #f3e8ff 0%, #e9d5ff 100%);
      border: 1px solid #d8b4fe;
      border-radius: 0.75rem;
      padding: 1rem 1.2rem;
      margin-top: 1.2rem;
      text-align: center;
    }
    .replay-encouragement h4 {
      margin: 0 0 0.4rem;
      font-size: 1rem;
      color: #7c3aed;
    }
    .replay-encouragement p {
      margin: 0;
      font-size: 0.9rem;
      color: #6d28d9;
    }
    .resources-section {
      background: #f8fafc;
      border: 1px solid #e2e8f0;
      border-radius: 0.75rem;
      padding: 1rem 1.2rem;
      margin-top: 1rem;
    }
    .resources-section h4 {
      margin: 0 0 0.6rem;
      font-size: 1rem;
      color: #334155;
      display: flex;
      align-items: center;
      gap: 0.4rem;
    }
    .resources-section p {
      margin: 0;
      font-size: 0.88rem;
      color: #475569;
      line-height: 1.5;
    }
    #learning-focus {
      margin-top: 1.2rem;
      padding: 1rem 1.2rem;
      border: 1px solid #d1d5db;
      border-radius: 0.75rem;
      background: #fffbef;
    }
    #learning-focus h3 {
      margin: 0 0 0.6rem;
      font-size: 1.05rem;
      color: #92400e;
    }
    #learning-focus p {
      margin: 0;
      font-size: 0.92rem;
      color: #78350f;
      line-height: 1.55;
    }
    body.summary-mode #result-card {
      max-width: 750px;
      margin: 0 auto;
    }
    .final-score-display {
      display: flex;
      justify-content: center;
      gap: 2rem;
      margin: 1rem 0 1.5rem;
      flex-wrap: wrap;
    }
    .score-circle {
      text-align: center;
    }
    .score-circle .score-value {
      width: 70px;
      height: 70px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.4rem;
      font-weight: 700;
      margin: 0 auto 0.4rem;
    }
    .score-circle .score-label {
      font-size: 0.8rem;
      color: #6b7280;
    }
    .score-circle.profit .score-value {
      background: linear-gradient(135deg, #dcfce7, #bbf7d0);
      color: #166534;
      border: 2px solid #86efac;
    }
    .score-circle.accuracy .score-value {
      background: linear-gradient(135deg, #dbeafe, #bfdbfe);
      color: #1e40af;
      border: 2px solid #93c5fd;
    }
    
    /* ==========================================
       Mini-Game: Value Drop - Enhanced Edition
       ========================================== */
    #minigame-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0f0826 0%, #1a1040 50%, #0d0620 100%);
      z-index: 1000;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-family: system-ui, -apple-system, sans-serif;
    }
    #minigame-overlay.active {
      display: flex;
    }
    #mg-game-wrapper {
      width: 100%;
      max-width: 650px;
      padding: 1rem;
    }
    #mg-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.5rem;
      padding: 0 0.5rem;
    }
    #mg-title {
      font-size: 1.5rem;
      font-weight: 800;
      background: linear-gradient(90deg, #a78bfa, #fb7185, #fbbf24);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-shadow: 0 0 30px rgba(167, 139, 250, 0.5);
    }
    #mg-stats {
      display: flex;
      gap: 0.75rem;
    }
    .mg-stat-box {
      background: rgba(255,255,255,0.08);
      backdrop-filter: blur(10px);
      padding: 0.35rem 0.7rem;
      border-radius: 0.6rem;
      border: 1px solid rgba(255,255,255,0.1);
      text-align: center;
      min-width: 55px;
    }
    .mg-stat-label {
      font-size: 0.6rem;
      text-transform: uppercase;
      color: #a5b4fc;
      letter-spacing: 0.05em;
    }
    .mg-stat-val {
      font-size: 1.1rem;
      font-weight: 700;
      color: #fbbf24;
    }
    #mg-timer-val {
      color: #4ade80;
    }
    #mg-timer-val.danger {
      color: #f87171;
      animation: pulse 0.5s ease-in-out infinite;
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    #mg-arena {
      position: relative;
      width: 100%;
      height: 520px;
      background: linear-gradient(180deg, 
        rgba(30, 20, 60, 0.9) 0%, 
        rgba(20, 10, 40, 0.95) 100%);
      border-radius: 1.2rem;
      overflow: hidden;
      border: 2px solid rgba(139, 92, 246, 0.3);
      box-shadow: 
        0 0 40px rgba(139, 92, 246, 0.2),
        inset 0 0 60px rgba(0, 0, 0, 0.5);
    }
    /* Starfield effect */
    #mg-arena::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-image: 
        radial-gradient(1px 1px at 20px 30px, white, transparent),
        radial-gradient(1px 1px at 40px 70px, rgba(255,255,255,0.8), transparent),
        radial-gradient(1px 1px at 50px 160px, rgba(255,255,255,0.6), transparent),
        radial-gradient(1px 1px at 90px 40px, white, transparent),
        radial-gradient(1px 1px at 130px 80px, rgba(255,255,255,0.7), transparent),
        radial-gradient(1px 1px at 180px 20px, white, transparent),
        radial-gradient(1px 1px at 200px 100px, rgba(255,255,255,0.5), transparent),
        radial-gradient(1px 1px at 250px 60px, white, transparent),
        radial-gradient(1px 1px at 300px 140px, rgba(255,255,255,0.8), transparent),
        radial-gradient(1px 1px at 350px 30px, white, transparent),
        radial-gradient(1px 1px at 400px 90px, rgba(255,255,255,0.6), transparent),
        radial-gradient(1px 1px at 450px 50px, white, transparent),
        radial-gradient(1px 1px at 500px 120px, rgba(255,255,255,0.7), transparent),
        radial-gradient(1px 1px at 550px 70px, white, transparent);
      opacity: 0.4;
      pointer-events: none;
    }
    /* Falling Product */
    #mg-falling-product {
      position: absolute;
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: left 0.1s ease-out;
      z-index: 10;
      filter: drop-shadow(0 10px 30px rgba(0,0,0,0.5));
    }
    #mg-product-emoji {
      font-size: 3rem;
      line-height: 1;
      animation: float 2s ease-in-out infinite;
      filter: drop-shadow(0 0 15px rgba(255,255,255,0.3));
    }
    @keyframes float {
      0%, 100% { transform: translateY(0) rotate(-2deg); }
      50% { transform: translateY(-5px) rotate(2deg); }
    }
    #mg-product-label {
      margin-top: 0.15rem;
      padding: 0.2rem 0.6rem;
      background: rgba(0,0,0,0.7);
      border-radius: 999px;
      font-size: 0.75rem;
      font-weight: 600;
      color: white;
      white-space: nowrap;
      border: 1px solid rgba(255,255,255,0.2);
      max-width: 160px;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    /* Mechanism Bundle Columns */
    #mg-columns {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      display: flex;
      height: 90px;
      z-index: 5;
      gap: 4px;
      padding: 0 4px;
    }
    .mg-col {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 0.3rem 0.2rem;
      position: relative;
      cursor: pointer;
      transition: all 0.2s;
      border-radius: 0.6rem 0.6rem 0 0;
    }
    .mg-col::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(180deg, rgba(100, 100, 140, 0.2) 0%, rgba(60, 60, 100, 0.5) 100%);
      border-radius: 0.6rem 0.6rem 0 0;
      opacity: 0.8;
      transition: all 0.2s;
    }
    .mg-col::after {
      content: '';
      position: absolute;
      top: -430px;
      left: 50%;
      width: 2px;
      height: 430px;
      background: linear-gradient(180deg, transparent 0%, rgba(255,255,255,0.06) 100%);
      pointer-events: none;
    }
    .mg-col.active::before {
      background: linear-gradient(180deg, rgba(139, 92, 246, 0.4) 0%, rgba(139, 92, 246, 0.7) 100%);
      opacity: 1;
      box-shadow: 0 -5px 25px rgba(139, 92, 246, 0.4);
    }
    .mg-col.active::after {
      background: linear-gradient(180deg, transparent 0%, rgba(139, 92, 246, 0.2) 100%);
      width: 3px;
    }
    .mg-col.flash-ideal::before {
      background: linear-gradient(180deg, rgba(34, 197, 94, 0.5) 0%, rgba(34, 197, 94, 0.9) 100%) !important;
      opacity: 1 !important;
      box-shadow: 0 -10px 30px rgba(34, 197, 94, 0.5);
    }
    .mg-col.flash-good::before {
      background: linear-gradient(180deg, rgba(234, 179, 8, 0.5) 0%, rgba(234, 179, 8, 0.9) 100%) !important;
      opacity: 1 !important;
      box-shadow: 0 -10px 30px rgba(234, 179, 8, 0.5);
    }
    .mg-col.flash-bad::before {
      background: linear-gradient(180deg, rgba(239, 68, 68, 0.5) 0%, rgba(239, 68, 68, 0.9) 100%) !important;
      opacity: 1 !important;
      box-shadow: 0 -10px 30px rgba(239, 68, 68, 0.5);
    }
    .mg-col.flash-neutral::before {
      background: linear-gradient(180deg, rgba(107, 114, 128, 0.5) 0%, rgba(107, 114, 128, 0.9) 100%) !important;
      opacity: 1 !important;
    }
    .mg-col:hover::before {
      opacity: 1;
      box-shadow: 0 -3px 15px rgba(139, 92, 246, 0.2);
    }
    .mg-col-label {
      position: relative;
      z-index: 2;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.15rem;
      text-align: center;
    }
    .mg-bundle-title {
      font-size: 0.75rem;
      font-weight: 800;
      text-transform: uppercase;
      letter-spacing: 0.04em;
      color: #fff;
      text-shadow: 0 1px 4px rgba(0,0,0,0.7);
      line-height: 1.1;
    }
    .mg-bundle-mechs {
      font-size: 0.6rem;
      font-weight: 500;
      color: rgba(196, 181, 253, 0.85);
      text-shadow: 0 1px 3px rgba(0,0,0,0.6);
      line-height: 1.2;
    }
    .mg-col[data-bundle="0"] .mg-bundle-title { color: #c4b5fd; }
    .mg-col[data-bundle="1"] .mg-bundle-title { color: #86efac; }
    .mg-col[data-bundle="2"] .mg-bundle-title { color: #7dd3fc; }
    /* Hint bar */
    #mg-hint-bar {
      position: absolute;
      top: 0.4rem;
      left: 50%;
      transform: translateX(-50%);
      font-size: 0.7rem;
      color: #c4b5fd;
      background: rgba(0,0,0,0.5);
      padding: 0.2rem 0.8rem;
      border-radius: 999px;
      z-index: 15;
      pointer-events: none;
      white-space: nowrap;
    }
    /* Intro & End Screens */
    #mg-intro-screen, #mg-end-screen {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: rgba(15, 8, 38, 0.97);
      border-radius: 1.2rem;
      padding: 2rem;
      text-align: center;
      z-index: 20;
    }
    #mg-intro-screen h2, #mg-end-screen h2 {
      font-size: 2rem;
      font-weight: 800;
      background: linear-gradient(90deg, #a78bfa, #fb7185);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin: 0 0 0.75rem;
    }
    #mg-intro-screen p, #mg-end-screen p {
      color: #c4b5fd;
      font-size: 0.95rem;
      margin: 0 0 0.5rem;
      max-width: 380px;
      line-height: 1.5;
    }
    .mg-big-btn {
      background: linear-gradient(135deg, #8b5cf6, #6366f1);
      color: white;
      border: none;
      padding: 0.85rem 2rem;
      font-size: 1.1rem;
      font-weight: 700;
      border-radius: 999px;
      cursor: pointer;
      box-shadow: 0 8px 30px rgba(139, 92, 246, 0.5);
      transition: all 0.2s;
      margin-top: 0.75rem;
    }
    .mg-big-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 12px 40px rgba(139, 92, 246, 0.6);
    }
    .mg-big-btn.green {
      background: linear-gradient(135deg, #22c55e, #16a34a);
      box-shadow: 0 8px 30px rgba(34, 197, 94, 0.5);
    }
    #mg-final-score {
      font-size: 4rem;
      font-weight: 800;
      background: linear-gradient(90deg, #fbbf24, #f59e0b);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin: 0.5rem 0;
      text-shadow: 0 0 40px rgba(251, 191, 36, 0.5);
    }
    #mg-end-message {
      color: #86efac;
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 1rem;
    }
    /* Result flash */
    .mg-result-flash {
      position: absolute;
      top: 45%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 1.8rem;
      font-weight: 800;
      padding: 0.6rem 1.5rem;
      border-radius: 1rem;
      animation: flashPop 0.9s ease-out forwards;
      z-index: 30;
      pointer-events: none;
      white-space: nowrap;
    }
    .mg-result-flash.ideal {
      background: linear-gradient(135deg, #22c55e, #16a34a);
      color: white;
      box-shadow: 0 0 40px rgba(34, 197, 94, 0.6);
    }
    .mg-result-flash.good {
      background: linear-gradient(135deg, #eab308, #ca8a04);
      color: white;
      box-shadow: 0 0 40px rgba(234, 179, 8, 0.6);
    }
    .mg-result-flash.bad {
      background: linear-gradient(135deg, #ef4444, #dc2626);
      color: white;
      box-shadow: 0 0 40px rgba(239, 68, 68, 0.6);
    }
    .mg-result-flash.neutral {
      background: linear-gradient(135deg, #6b7280, #4b5563);
      color: white;
      box-shadow: 0 0 40px rgba(107, 114, 128, 0.4);
    }
    @keyframes flashPop {
      0% { opacity: 0; transform: translate(-50%, -50%) scale(0.3); }
      15% { opacity: 1; transform: translate(-50%, -50%) scale(1.15); }
      30% { transform: translate(-50%, -50%) scale(1); }
      100% { opacity: 0; transform: translate(-50%, -70%) scale(0.8); }
    }
    /* Sound toggle */
    #mg-sound-toggle {
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      background: rgba(255,255,255,0.1);
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 0.5rem;
      padding: 0.3rem 0.5rem;
      font-size: 1.2rem;
      cursor: pointer;
      z-index: 25;
      transition: all 0.2s;
    }
    #mg-sound-toggle:hover {
      background: rgba(255,255,255,0.2);
    }
    
    /* Intro Screen Styles */
    #intro-screen {
      max-width: 800px;
      width: 100%;
      margin: 1rem;
      background: #f9fafb;
      color: #111827;
      border-radius: 1.5rem;
      padding: 2.5rem 2rem;
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.45);
      border: 1px solid #e5e7eb;
      text-align: center;
    }
    #intro-screen h1 {
      font-size: 2.4rem;
      margin: 0 0 0.5rem;
      color: #111827;
    }
    #intro-screen .intro-emoji {
      font-size: 3rem;
      margin-bottom: 1rem;
    }
    #intro-screen .intro-tagline {
      font-size: 1.15rem;
      color: #4b5563;
      margin: 0 0 1.8rem;
    }
    #intro-screen .intro-section {
      text-align: left;
      background: #ffffff;
      border: 1px solid #e5e7eb;
      border-radius: 1rem;
      padding: 1.2rem 1.4rem;
      margin-bottom: 1.2rem;
    }
    #intro-screen .intro-section h2 {
      font-size: 1.1rem;
      margin: 0 0 0.6rem;
      color: #166534;
      display: flex;
      align-items: center;
      gap: 0.4rem;
    }
    #intro-screen .intro-section p {
      font-size: 0.95rem;
      color: #374151;
      margin: 0 0 0.5rem;
      line-height: 1.55;
    }
    #intro-screen .intro-section p:last-child {
      margin-bottom: 0;
    }
    #intro-screen .intro-concepts {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-top: 0.8rem;
    }
    #intro-screen .intro-concept-tag {
      background: #ecfdf5;
      border: 1px solid #a7f3d0;
      color: #065f46;
      padding: 0.3rem 0.7rem;
      border-radius: 999px;
      font-size: 0.85rem;
      font-weight: 500;
    }
    #intro-screen .intro-ranks {
      display: flex;
      justify-content: center;
      gap: 1rem;
      flex-wrap: wrap;
      margin-top: 0.8rem;
    }
    #intro-screen .intro-rank {
      display: flex;
      align-items: center;
      gap: 0.3rem;
      font-size: 0.95rem;
    }
    #intro-screen .intro-rank-emoji {
      font-size: 1.3rem;
    }
    #start-btn {
      margin-top: 1.5rem;
      border-radius: 999px;
      border: none;
      padding: 1rem 2.5rem;
      font-size: 1.15rem;
      cursor: pointer;
      background: linear-gradient(135deg, #22c55e, #16a34a);
      color: white;
      font-weight: 700;
      box-shadow: 0 8px 24px rgba(22, 163, 74, 0.4);
      transition: transform 0.1s ease-out, box-shadow 0.1s ease-out;
    }
    #start-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 30px rgba(22, 163, 74, 0.5);
    }
    #intro-screen .intro-footer {
      margin-top: 1.5rem;
      font-size: 0.85rem;
      color: #6b7280;
    }
    #game-root.hidden {
      display: none;
    }
    /* Mini-Game: Protection Bundle Builder */
    #minigame-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(15, 23, 42, 0.92);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      padding: 1rem;
    }
    #minigame-overlay.active {
      display: flex;
    }
    #minigame-container {
      background: #f9fafb;
      border-radius: 1.5rem;
      padding: 1.5rem;
      max-width: 700px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 25px 60px rgba(0, 0, 0, 0.5);
      border: 2px solid #22c55e;
    }
    #minigame-header {
      text-align: center;
      margin-bottom: 1rem;
    }
    #minigame-header h2 {
      margin: 0 0 0.3rem;
      font-size: 1.4rem;
      color: #111827;
    }
    #minigame-header p {
      margin: 0;
      font-size: 0.9rem;
      color: #6b7280;
    }
    #minigame-stats {
      display: flex;
      justify-content: center;
      gap: 1.5rem;
      margin-bottom: 1rem;
    }
    .minigame-stat {
      text-align: center;
    }
    .minigame-stat-value {
      font-size: 1.5rem;
      font-weight: 700;
      color: #22c55e;
    }
    .minigame-stat-value.timer {
      color: #f59e0b;
    }
    .minigame-stat-value.timer.urgent {
      color: #ef4444;
      animation: pulse 0.5s infinite;
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    .minigame-stat-label {
      font-size: 0.75rem;
      color: #6b7280;
      text-transform: uppercase;
    }
    #minigame-product-area {
      background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
      border: 2px dashed #22c55e;
      border-radius: 1rem;
      padding: 1.2rem;
      min-height: 140px;
      margin-bottom: 1rem;
      text-align: center;
      transition: all 0.2s;
    }
    #minigame-product-area.drag-over {
      background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
      border-style: solid;
    }
    #minigame-product-name {
      font-size: 1.2rem;
      font-weight: 700;
      color: #166534;
      margin-bottom: 0.3rem;
    }
    #minigame-product-hint {
      font-size: 0.85rem;
      color: #047857;
      margin-bottom: 0.8rem;
    }
    #minigame-drop-zone {
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
      justify-content: center;
      min-height: 36px;
      padding: 0.5rem;
      background: rgba(255,255,255,0.5);
      border-radius: 0.5rem;
    }
    #minigame-drop-zone .mechanism-chip {
      background: #166534;
      color: white;
      cursor: default;
    }
    #minigame-mechanisms {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      justify-content: center;
      margin-bottom: 1rem;
      padding: 0.5rem;
      background: #f3f4f6;
      border-radius: 0.75rem;
    }
    .mechanism-chip {
      padding: 0.5rem 0.9rem;
      border-radius: 999px;
      font-size: 0.85rem;
      font-weight: 600;
      cursor: grab;
      transition: all 0.15s;
      user-select: none;
      border: 2px solid transparent;
    }
    .mechanism-chip:active {
      cursor: grabbing;
    }
    .mechanism-chip.dragging {
      opacity: 0.5;
      transform: scale(0.95);
    }
    .mechanism-chip.chip-patent { background: #ede9fe; color: #5b21b6; border-color: #c4b5fd; }
    .mechanism-chip.chip-secret { background: #dcfce7; color: #166534; border-color: #86efac; }
    .mechanism-chip.chip-trademark { background: #ffedd5; color: #c2410c; border-color: #fdba74; }
    .mechanism-chip.chip-copyright { background: #fce7f3; color: #be185d; border-color: #f9a8d4; }
    .mechanism-chip.chip-speed { background: #e0f2fe; color: #0369a1; border-color: #7dd3fc; }
    .mechanism-chip.chip-complexity { background: #f3e8ff; color: #7c3aed; border-color: #d8b4fe; }
    .mechanism-chip.chip-contracts { background: #fef3c7; color: #b45309; border-color: #fcd34d; }
    .mechanism-chip.chip-assets { background: #cffafe; color: #0e7490; border-color: #67e8f9; }
    .mechanism-chip.chip-community { background: #fef9c3; color: #a16207; border-color: #fde047; }
    .mechanism-chip.chip-design { background: #dbeafe; color: #1d4ed8; border-color: #93c5fd; }
    #minigame-buttons {
      display: flex;
      gap: 0.75rem;
      justify-content: center;
    }
    .minigame-btn {
      padding: 0.65rem 1.4rem;
      border-radius: 999px;
      border: none;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.1s;
    }
    .minigame-btn-submit {
      background: linear-gradient(135deg, #22c55e, #16a34a);
      color: white;
      box-shadow: 0 4px 12px rgba(22, 163, 74, 0.35);
    }
    .minigame-btn-submit:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 16px rgba(22, 163, 74, 0.45);
    }
    .minigame-btn-submit:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }
    .minigame-btn-skip {
      background: #e5e7eb;
      color: #374151;
    }
    .minigame-btn-skip:hover {
      background: #d1d5db;
    }
    #minigame-feedback {
      display: none;
      text-align: center;
      padding: 1rem;
      border-radius: 0.75rem;
      margin-top: 1rem;
    }
    #minigame-feedback.show {
      display: block;
    }
    #minigame-feedback.correct {
      background: #dcfce7;
      border: 1px solid #86efac;
    }
    #minigame-feedback.partial {
      background: #fef3c7;
      border: 1px solid #fcd34d;
    }
    #minigame-feedback.incorrect {
      background: #fee2e2;
      border: 1px solid #fca5a5;
    }
    #minigame-feedback h3 {
      margin: 0 0 0.4rem;
      font-size: 1.1rem;
    }
    #minigame-feedback.correct h3 { color: #166534; }
    #minigame-feedback.partial h3 { color: #a16207; }
    #minigame-feedback.incorrect h3 { color: #b91c1c; }
    #minigame-feedback p {
      margin: 0;
      font-size: 0.9rem;
      color: #374151;
    }
    #minigame-ideal-bundle {
      margin-top: 0.6rem;
      font-size: 0.85rem;
      color: #4b5563;
    }
    #minigame-results {
      display: none;
      text-align: center;
    }
    #minigame-results.show {
      display: block;
    }
    #minigame-results h2 {
      font-size: 1.3rem;
      margin: 0 0 0.5rem;
      color: #111827;
    }
    .minigame-final-score {
      font-size: 2.5rem;
      font-weight: 700;
      color: #22c55e;
      margin: 0.5rem 0;
    }
    #minigame-results p {
      font-size: 0.95rem;
      color: #4b5563;
      margin: 0.5rem 0 1rem;
    }
  </style>
</head>
<body>
  <!-- Cookie Consent Banner (GDPR opt-in) -->
  <div id="cookie-banner" style="display:none;">
    <p>üìä This game uses cookies (Google Analytics) to help improve the simulation and to assess patterns of use. We do not track you after use. No advertising, no personal data collected. You can play without accepting these cookies ‚Äî the game works the same.</p>
    <div class="cookie-btns">
      <button class="cookie-accept" onclick="acceptCookies()">Accept cookies</button>
      <button class="cookie-decline" onclick="declineCookies()">No thanks</button>
    </div>
  </div>

  <!-- Intro Screen -->
  <div id="intro-screen">
    <div class="intro-emoji">üß™</div>
    <h1>Appropriation Strategy Lab</h1>
    <p class="intro-tagline">Learn how innovative firms capture value from their ideas</p>
    
    <div class="intro-section">
      <h2>üéØ What's This About?</h2>
      <p>Every time a company creates something new, competitors want to copy it. The <strong>appropriation strategy</strong> is how firms protect and profit from their innovations.</p>
      <p>In this game, you'll face real-world scenarios and decide which combination of tools‚Äîpatents, secrecy, contracts, brand-building, and more‚Äîbest fits each situation.</p>
    </div>
    
    <div class="intro-section">
      <h2>üõ†Ô∏è Your Toolkit</h2>
      <p>You'll choose from a mix of protection mechanisms:</p>
      <div class="intro-concepts">
        <span class="intro-concept-tag">Patents</span>
        <span class="intro-concept-tag">Trade Secrets</span>
        <span class="intro-concept-tag">Trade Marks</span>
        <span class="intro-concept-tag">Copyright</span>
        <span class="intro-concept-tag">Lead Time</span>
        <span class="intro-concept-tag">Complexity</span>
        <span class="intro-concept-tag">Contracts</span>
        <span class="intro-concept-tag">Complementary Assets</span>
      </div>
    </div>
    
    <div class="intro-section">
      <h2>üéÆ How to Play</h2>
      <p>You'll face <strong>10 scenarios</strong> featuring different products and services. For each one, read the situation carefully‚Äîthink about how easy it is to copy, what's visible to competitors, and what assets matter most.</p>
      <p>Then pick the strategy you think best captures value for the innovating firm. You'll earn points based on how well your choice fits the context!</p>
    </div>
    
    <div class="intro-section">
      <h2>üïπÔ∏è Bonus: Value Drop!</h2>
      <p>Partway through the game, you'll unlock a <strong>Tetris-style bonus round</strong>! Products fall from the sky ‚Äî use arrow keys to guide each one into the right <strong>mechanism column</strong>. Match products to their ideal mechanisms to score big!</p>
      <p>It's a fun way to build intuition for matching mechanisms to products under time pressure!</p>
    </div>
    
    <div class="intro-section">
      <h2>üèÜ Earn Your Rank</h2>
      <p>Your final rank depends on your profit efficiency and how often you pick the best-aligned strategy:</p>
      <div class="intro-ranks">
        <span class="intro-rank"><span class="intro-rank-emoji">ü¶ã</span> Butterfly</span>
        <span class="intro-rank"><span class="intro-rank-emoji">ü¶î</span> Hedgehog</span>
        <span class="intro-rank"><span class="intro-rank-emoji">ü¶ä</span> Fox</span>
        <span class="intro-rank"><span class="intro-rank-emoji">ü¶à</span> Shark</span>
        <span class="intro-rank"><span class="intro-rank-emoji">üê≤</span> Dragon</span>
      </div>
    </div>
    
    <button id="start-btn">Start Playing ‚Üí</button>
    
    <p class="intro-footer">Based on David Teece's framework for profiting from innovation</p>
    
    <div style="margin-top: 1.5rem; padding-top: 1rem; border-top: 1px solid #e5e7eb; text-align: center;">
      <p style="margin: 0 0 0.3rem; font-size: 0.85rem; color: #4b5563;">Developed by <strong>Ammon Salter</strong></p>
      <p style="margin: 0 0 0.3rem; font-size: 0.7rem; color: #9ca3af;">Contributors: Federico Bignone, Paola Criscuolo, Almantas Palubinskas</p>
      <p style="margin: 0 0 0.3rem; font-size: 0.7rem; color: #9ca3af;">Built with AI assistance: Claude, Gemini, GPT-5</p>
      <p style="margin: 0 0 0.5rem; font-size: 0.7rem; color: #9ca3af;">¬© 2025 Ammon Salter ¬∑ Licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" style="color: #16a34a; text-decoration: underline;">CC BY-NC-SA 4.0</a></p>
      <p style="margin: 0; font-size: 0.65rem; color: #b0b0b0;">üìä This game uses cookies (Google Analytics) to help improve the simulation and to assess patterns of use. We do not track you after use. No advertising, no personal data collected. <span class="ga-consent-status"></span> <a href="javascript:void(0)" onclick="changeConsentPreference()" class="ga-consent-change" style="color: #9ca3af; text-decoration: underline; cursor: pointer; display: none;">Change preference</a></p>
    </div>
  </div>

  <!-- Game Screen (initially hidden) -->
  <div id="game-root" class="hidden">
    <h1>Appropriation Strategy Lab</h1>
    <p class="subtitle">
      For each innovation, pick how the firm tries to stop rivals copying it.
      Think about <strong>appropriation mechanisms</strong> (formal and informal),
      <strong>complementary assets</strong>, and <strong>contracts</strong>.
      You have 10 rounds, with a different product or service each time.
      Rankings go from <strong>Butterfly</strong> ü¶ã to <strong>Dragon</strong> üê≤.
    </p>
    <div id="stats-bar">
      <div class="stat-pill">
        <span class="stat-label">Round</span>
        <span id="stat-round">1</span>
        <span class="muted">/ 10</span>
      </div>
      <div class="stat-pill">
        <span class="stat-label">Total net profit</span>
        <span id="stat-profit">0</span>
      </div>
      <div class="stat-pill">
        <span class="stat-label">Potential max profit</span>
        <span id="stat-max-profit">0</span>
      </div>
      <div class="stat-pill">
        <span class="stat-label">Best-aligned choices</span>
        <span id="stat-correct">0</span>
        <span class="muted">/</span>
        <span id="stat-answered">0</span>
      </div>
    </div>
    <div id="layout">
      <section id="scenario-card">
        <h2 id="scenario-title"></h2>
        <p id="scenario-what"></p>
        <p id="scenario-description"></p>
        <ul id="key-facts">
          <li>
            <span class="fact-label">How easy is it to copy?</span>
            <span id="fact-imitability"></span>
          </li>
          <li>
            <span class="fact-label">What can others see?</span>
            <span id="fact-visibility"></span>
          </li>
          <li>
            <span class="fact-label">Key complementary assets:</span>
            <span id="fact-assets"></span>
          </li>
          <li>
            <span class="fact-label">Market / legal context:</span>
            <span id="fact-context"></span>
          </li>
        </ul>
        <div id="choices-label">Choose an appropriation strategy</div>
        <div id="choices"></div>
      </section>
      <section id="result-card">
        <h2>Round outcome</h2>
        <div id="result-heading">Make a choice to see the outcome.</div>
        <p id="result-text"></p>
        <p id="result-metrics"></p>
        <p id="profit-text"></p>
        <p id="concept-link"></p>

        <!-- Enhanced End Screen Elements (hidden during gameplay) -->
        <div id="encouragement-banner" class="encouragement-banner" style="display:none;">
          <h3 id="encouragement-title"></h3>
          <p id="encouragement-message"></p>
        </div>

        <div id="final-scores" class="final-score-display" style="display:none;">
          <div class="score-circle profit">
            <div class="score-value" id="score-efficiency">0%</div>
            <div class="score-label">Profit Efficiency</div>
          </div>
          <div class="score-circle accuracy">
            <div class="score-value" id="score-accuracy">0/10</div>
            <div class="score-label">Best Choices</div>
          </div>
        </div>

        <div id="strengths-section" class="strengths-section" style="display:none;">
          <h4>üí™ What You Did Well</h4>
          <ul id="strengths-list"></ul>
        </div>

        <div id="growth-section" class="growth-section" style="display:none;">
          <h4>üå± Areas to Explore</h4>
          <div id="growth-content"></div>
        </div>

        <div id="tips-section" class="tips-section" style="display:none;">
          <h4>üí° Quick Tips for Next Time</h4>
          <ul id="tips-list"></ul>
        </div>

        <div id="learning-focus" style="display:none;">
            <h3>üìö Deepen Your Understanding</h3>
            <p id="focus-text"></p>
        </div>
        
        <div id="concept-summary" style="display:none;">
          <h3>üß† Key Concepts from This Game</h3>
          <ul id="concept-list"></ul>
        </div>

        <div id="replay-encouragement" class="replay-encouragement" style="display:none;">
          <h4>üéÆ Ready for Another Round?</h4>
          <p id="replay-message"></p>
        </div>

        <div id="resources-section" class="resources-section" style="display:none;">
          <h4>üìñ Want to Learn More?</h4>
          <p>The concepts in this game are based on David Teece's influential framework on "Profiting from Innovation." Understanding appropriability regimes and complementary assets is essential for anyone working in innovation management, entrepreneurship, or technology strategy.</p>
        </div>
        
        <div id="credits-section" style="display:none; margin-top: 1.5rem; padding: 1rem; background: #f9fafb; border-radius: 0.75rem; border: 1px solid #e5e7eb; text-align: center;">
          <p style="margin: 0 0 0.3rem; font-size: 0.85rem; color: #374151;">Developed by <strong>Ammon Salter</strong></p>
          <p style="margin: 0 0 0.3rem; font-size: 0.75rem; color: #6b7280;">Warwick Business School, University of Warwick</p>
          <p style="margin: 0 0 0.3rem; font-size: 0.7rem; color: #9ca3af;">Contributors: Federico Bignone, Paola Criscuolo, Almantas Palubinskas</p>
          <p style="margin: 0 0 0.5rem; font-size: 0.7rem; color: #9ca3af;">¬© 2025 Ammon Salter ¬∑ Licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" style="color: #16a34a; text-decoration: underline;">CC BY-NC-SA 4.0</a></p>
          <p style="margin: 0; font-size: 0.65rem; color: #b0b0b0;">üìä This game uses cookies (Google Analytics) to help improve the simulation and to assess patterns of use. We do not track you after use. No advertising, no personal data collected. <span class="ga-consent-status"></span> <a href="javascript:void(0)" onclick="changeConsentPreference()" class="ga-consent-change" style="color: #9ca3af; text-decoration: underline; cursor: pointer; display: none;">Change preference</a></p>
        </div>

        <div id="next-row">
          <div>
            You will see 10 different situations. No product or service repeats in this game.
          </div>
          <button id="next-btn" disabled>
            Next scenario
          </button>
        </div>
      </section>
    </div>
    <div id="legend">
      <p style="margin: 0 0 0.25rem;">
        <strong>Formal tools:</strong>
      </p>
      <p style="margin: 0 0 0.2rem;">
        <span class="badge badge-patent">
          Patents
          <span class="info-icon" data-target="patent-info">?</span>
        </span>
        protect new technical ideas (if you meet the patent requirements).
      </p>
      <p style="margin: 0 0 0.2rem;">
        <span class="badge badge-mark">
          Trade marks
          <span class="info-icon" data-target="trademark-info">?</span>
        </span>
        protect names, logos and brand identity.
      </p>
      <p style="margin: 0 0 0.2rem;">
        <span class="badge badge-copyright">
          Copyright
          <span class="info-icon" data-target="copyright-info">?</span>
        </span>
        protects code, text, images, music and other creative work.
      </p>
      <p style="margin: 0.4rem 0 0.25rem;">
        <strong>Informal / practical methods:</strong>
      </p>
      <p style="margin: 0 0 0.2rem;">
        <span class="badge badge-secret">
          Secrecy
          <span class="info-icon" data-target="secret-info">?</span>
        </span>
        keeping valuable know-how confidential (e.g. recipes, algorithms, processes).
      </p>
      <p style="margin: 0 0 0.2rem;">
        <span class="badge badge-speed">
          Lead time &amp; first-mover
          <span class="info-icon" data-target="leadtime-info">?</span>
        </span>
        staying ahead through speed and learning.
      </p>
      <p style="margin: 0 0 0.2rem;">
        <span class="badge badge-complexity">
          Complexity &amp; tacit skill
          <span class="info-icon" data-target="complexity-info">?</span>
        </span>
        making it hard to copy in practice.
      </p>
      <p style="margin: 0 0 0.2rem;">
        <span class="badge badge-community">
          Community &amp; switching costs
          <span class="info-icon" data-target="community-info">?</span>
        </span>
        building attachment and making exit painful.
      </p>
      <p style="margin: 0.4rem 0 0.25rem;">
        <strong>Complementary assets &amp; contracts:</strong>
      </p>
      <p style="margin: 0 0 0.2rem;">
        <span class="badge badge-asset">
          Complementary assets
          <span class="info-icon" data-target="assets-info">?</span>
        </span>
        manufacturing, sales &amp; marketing, service &amp; support, data, platforms, distribution networks.
      </p>
      <p style="margin: 0 0 0.2rem;">
        <span class="badge badge-contract">
          Contracts
          <span class="info-icon" data-target="contracts-info">?</span>
        </span>
        NDAs, exclusivity, data rights, non-competes (where lawful), platform terms.
      </p>
      <p style="margin: 0.4rem 0 0;">
        In Teece‚Äôs terms, the key question is: <em>who actually gets the money?</em>
        Often it is the firm that chooses the right <strong>bundle</strong> of appropriation mechanisms,
        complementary assets and contractual arrangements for the context.
      </p>
    </div>
    <div id="mechanism-info" class="info-section">
      <h3 style="margin-top: 0;">More about appropriation mechanisms (click to expand)</h3>
      <div>
        <div class="info-title" data-target="patent-info">Patents ‚Äì when they work and when they fail</div>
        <div id="patent-info" class="info-content">
          <strong>Key requirements (in most jurisdictions):</strong><br>
          ‚Ä¢ Novelty ‚Äì not publicly disclosed anywhere in the world.<br>
          ‚Ä¢ Inventive step ‚Äì not obvious to a skilled person in the field.<br>
          ‚Ä¢ Industrial application ‚Äì usable in some kind of industry.<br><br>
          <strong>Important:</strong> public disclosure <em>before</em> filing (papers, demos, websites) can destroy novelty.<br><br>
          <strong>Good fit for:</strong> new molecules, engineered components, battery chemistries, some hardware/robotics.<br>
          <strong>Weak when:</strong> software/business methods with easy workarounds; weak enforcement; limited budget.
        </div>
      </div>
      <div>
        <div class="info-title" data-target="trademark-info">Trade marks ‚Äì protecting brand and identity</div>
        <div id="trademark-info" class="info-content">
          Protect names, logos, slogans and other signs that distinguish your products or services.<br><br>
          <strong>Good for:</strong> fashion, apps, platforms, consumer goods, media services.<br>
          <strong>Examples:</strong> Nike swoosh, Spotify logo, distinctive product names and colours.<br>
          <strong>Limits:</strong> does not stop copying of functional ideas or features; protects <em>identity</em>, not technology.
        </div>
      </div>
      <div>
        <div class="info-title" data-target="copyright-info">Copyright ‚Äì protecting creative expression</div>
        <div id="copyright-info" class="info-content">
          Protects software code, text, images, audio, video, artwork and other creative expression, usually automatically on creation.<br><br>
          <strong>Good for:</strong> apps, games, user interfaces, artwork, audio libraries, training content.<br>
          <strong>Limits:</strong> protects the specific expression, not the abstract idea or function (others can re-write from scratch).
        </div>
      </div>
      <div>
        <div class="info-title" data-target="secret-info">Secrecy ‚Äì hidden know-how and information</div>
        <div id="secret-info" class="info-content">
          Works when the valuable information is not visible and access can be controlled (sometimes called trade secrets).<br><br>
          <strong>Examples:</strong> algorithms, recipes, pricing models, tuning parameters, manufacturing processes.<br>
          <strong>Needs:</strong> NDAs, access controls, security culture, careful partnerships.<br>
          <strong>Weak when:</strong> the product itself reveals the secret on inspection or simple lab analysis.
        </div>
      </div>
      <div>
        <div class="info-title" data-target="leadtime-info">Lead time &amp; first-mover advantage</div>
        <div id="leadtime-info" class="info-content">
          Being first to market and learning faster than competitors can give a temporary edge.<br><br>
          <strong>Examples:</strong> frequent app updates, rapid iteration, early network growth, fast deployment of physical networks.<br>
          <strong>Limits:</strong> advantage can fade quickly if rivals have more resources or better complementary assets.
        </div>
      </div>
      <div>
        <div class="info-title" data-target="complexity-info">Complexity &amp; tacit know-how</div>
        <div id="complexity-info" class="info-content">
          Some innovations are hard to copy because performance depends on deep experience, tuning and ‚Äúfeel‚Äù.<br><br>
          <strong>Examples:</strong> tuning of robots, complex chemical processes, artisan food and drink, advanced analytics pipelines.<br>
          <strong>Risk:</strong> key people leaving can seriously weaken this advantage if knowledge is not spread or documented.
        </div>
      </div>
      <div>
        <div class="info-title" data-target="community-info">Community &amp; switching costs</div>
        <div id="community-info" class="info-content">
          Users stay because they are embedded in a community, ecosystem or habit that makes leaving painful.<br><br>
          <strong>Examples:</strong> social networks, gaming platforms with expansions, subscription streaks, professional user groups.<br>
          <strong>Note:</strong> this is an informal but very powerful form of appropriation in digital markets.
        </div>
      </div>
      <div>
        <div class="info-title" data-target="assets-info">Complementary assets ‚Äì who controls the bottleneck?</div>
        <div id="assets-info" class="info-content">
          Assets needed to turn an invention into a product or service at scale: manufacturing, distribution, sales, service, data, regulatory approvals, platforms, agent networks.<br><br>
          <strong>Examples:</strong> pharma salesforces, mobile money agent networks, cloud infrastructure, hospital integrations.<br>
          <strong>Key Teece idea:</strong> the owner of the critical complementary assets often captures more value than the inventor.
        </div>
      </div>
      <div>
        <div class="info-title" data-target="contracts-info">Contracts ‚Äì invisible but powerful barriers</div>
        <div id="contracts-info" class="info-content">
          Contracts shape who can use what, where and with whom: NDAs, exclusivity clauses, licensing terms, data rights, non-competes (where lawful), platform terms, joint development agreements.<br><br>
          <strong>Examples:</strong> exclusive distributor agreements, long-term service contracts, ‚Äúno reverse engineering‚Äù clauses, data-sharing limits.<br>
          <strong>Insight:</strong> contracts often matter as much as formal IP for actual bargaining power and profit capture.
        </div>
      </div>
    </div>
  </div>

  <!-- Mini-Game: Value Drop - Enhanced -->
  <div id="minigame-overlay">
    <div id="mg-game-wrapper">
      <div id="mg-header">
        <div id="mg-title">üéÆ Value Drop!</div>
        <div id="mg-stats">
          <div class="mg-stat-box">
            <div class="mg-stat-label">Time</div>
            <div class="mg-stat-val" id="mg-timer-val">45</div>
          </div>
          <div class="mg-stat-box">
            <div class="mg-stat-label">Score</div>
            <div class="mg-stat-val" id="mg-score">0</div>
          </div>
          <div class="mg-stat-box">
            <div class="mg-stat-label">Caught</div>
            <div class="mg-stat-val" id="mg-products-done">0/6</div>
          </div>
        </div>
      </div>

      <div id="mg-arena">
        <button id="mg-sound-toggle" title="Toggle Music">üîä</button>
        
        <!-- Intro Screen -->
        <div id="mg-intro-screen">
          <h2>üéÆ Value Drop!</h2>
          <p>Products are falling! Guide each one into the best <strong>strategy bundle</strong>.</p>
          <p style="font-size:0.85rem; color:#c4b5fd;">Each column is a bundle of appropriation mechanisms. Match products to the right strategy!</p>
          <p><strong>How to play:</strong> Use <strong style="color:#fbbf24;">&#8592; &#8594; arrow keys</strong> to move, or <strong style="color:#fbbf24;">click a bundle</strong> to drop it there.</p>
          <p style="font-size:0.85rem; color:#4ade80;">&#127919; Best fit = <strong>+30 points</strong></p>
          <p style="font-size:0.85rem; color:#fbbf24;">&#128077; Good fit = <strong>+15 points</strong></p>
          <p style="font-size:0.85rem; color:#9ca3af;">&#10134; Neutral = <strong>+5 points</strong></p>
          <p style="font-size:0.85rem; color:#f87171;">&#10060; Poor fit = <strong>-10 points</strong></p>
          <p style="font-size:0.85rem; color:#a5b4fc;">Press <strong>&#8595;</strong> or <strong>Space</strong> to hard-drop!</p>
          <button class="mg-big-btn" id="mg-start-btn">üöÄ Start Game!</button>
        </div>

        <!-- End Screen -->
        <div id="mg-end-screen" style="display:none;">
          <h2>üéâ Time's Up!</h2>
          <div id="mg-final-score">0</div>
          <p id="mg-end-message">Great work!</p>
          <button class="mg-big-btn green" id="mg-continue-btn">Continue to Next Round ‚Üí</button>
        </div>

        <!-- Hint bar -->
        <div id="mg-hint-bar">Use &#8592; &#8594; arrow keys or click a bundle</div>

        <!-- Falling Product -->
        <div id="mg-falling-product" style="display:none;">
          <div id="mg-product-emoji">üíä</div>
          <div id="mg-product-label">Loading...</div>
        </div>

        <!-- Mechanism Bundle Columns -->
        <div id="mg-columns">
          <div class="mg-col" data-bundle="0" data-index="0">
            <div class="mg-col-label">
              <span class="mg-bundle-title">Formal IP</span>
              <span class="mg-bundle-mechs">Patents + Copyright + Trademarks</span>
            </div>
          </div>
          <div class="mg-col" data-bundle="1" data-index="1">
            <div class="mg-col-label">
              <span class="mg-bundle-title">Secrecy & Complexity</span>
              <span class="mg-bundle-mechs">Secrecy + Complexity</span>
            </div>
          </div>
          <div class="mg-col" data-bundle="2" data-index="2">
            <div class="mg-col-label">
              <span class="mg-bundle-title">Open & Network</span>
              <span class="mg-bundle-mechs">Community</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const MAX_ROUNDS = 10;
    // --- Scenario data: 30 scenarios for high replayability ---
    const allScenarios = [
      {
        id: 1,
        title: "New tablet medicine for migraine",
        what: "A new small-molecule pill that reduces migraine attacks.",
        description:
          "Your company, based in Europe, has developed a pill that works better than existing drugs. The chemistry is clearly new. Regulators in your region take pharmaceutical patents seriously and usually enforce them.",
        imitability:
          "Once on the market, other firms can see the active ingredient and dosage, but would still need time and money to copy it.",
        visibility:
          "The molecule and dosage appear on packaging and in public approvals.",
        assets:
          "Clinical trials team, regulatory know-how; big pharma incumbents control global sales and marketing.",
        context:
          "Strong pharmaceutical patents, expensive clinical trials, doctors and patients also care about brand names.",
        bestChoiceKey: "patentTrademarkContracts",
        choices: {
          patentTrademarkContracts: {
            label: "Patents on formula + brand building + co-promotion deal",
            tools: "Patents, trade marks, co-marketing contracts",
            meta: "You patent the molecule, create a brand, and sign co-promotion agreements with incumbents.",
            payoff: 5,
            protection: 5,
            cost: 4,
            feedback:
              "This combines a tight appropriability regime with access to complementary assets in sales and marketing. You share some profits but keep strong bargaining power.",
            concept:
              "Strong patents + access to downstream assets (sales) usually give the innovator the best chance to capture value."
          },
          tradeSecretOnly: {
            label: "Keep formula secret without patents + skip brand building investments",
            tools: "Secrecy, basic manufacturing assets, internal distribution, factory security",
            meta: "You avoid patent and branding costs and rely on factory secrecy hoping competitors cannot replicate your formula.",
            payoff: -2,
            protection: 2,
            cost: 2,
            feedback:
              "Regulators require disclosure and labs can test the pill, so secrecy is fragile. You save money in the short term but lose enforceable exclusivity and brand power.",
            concept:
              "If a product must be disclosed and is easy to analyse, secrecy alone is a very weak shield."
          },
          patentNoPartners: {
            label: "Patents without partners + build own global sales force from scratch",
            tools: "Patents, independent sales and marketing channels, direct distribution, retail",
            meta: "You keep full control and try to build your own sales, marketing and distribution channels independently.",
            payoff: 1,
            protection: 4,
            cost: 5,
            feedback:
              "You have strong patents but no complementary sales and marketing assets. Building them is extremely expensive and slow; incumbents may out-sell you.",
            concept:
              "Without the right complementary assets, even strong patents may not lead to high profits."
          }
        }
      },
      {
        id: 2,
        title: "Restaurant‚Äôs secret fried chicken coating",
        what: "A new spice mix and cooking process that customers love.",
        description:
          "You run a small chain of restaurants in the UK. Your new fried chicken coating becomes very popular. Customers only taste the final product; they never see the exact recipe or timing.",
        imitability:
          "Competitors can taste it and guess, but getting the exact mix and steps is hard.",
        visibility:
          "People see and taste the chicken, but not the recipe or detailed process.",
        assets:
          "Local brand, kitchen equipment, trained staff, some social media following.",
        context:
          "No realistic patents (too hard to define and easy to tweak around). Local market, strong word-of-mouth.",
        bestChoiceKey: "secretNDAs",
        choices: {
          secretNDAs: {
            label: "Secrecy on recipe + NDAs and non-compete clauses for key staff",
            tools: "Secrecy, staff NDAs, non-competes where lawful, training programmes",
            meta: "Only a few trusted staff know the full recipe; contracts, culture and staff loyalty support secrecy.",
            payoff: 4,
            protection: 4,
            cost: 3,
            feedback:
              "This matches the setting well. Secrecy backed by NDAs, non-competes and careful training can protect your know-how without heavy legal cost.",
            concept:
              "Low observability + people-based know-how ‚áí secrecy plus staff contracts are powerful."
          },
          openRecipeBrandOnly: {
            label: "Publish recipe in a cookbook + rely solely on brand and ambiance",
            tools: "Brand identity, d√©cor and atmosphere, service experience, marketing",
            meta: "You focus on the story and experience rather than keeping the recipe secret from competitors.",
            payoff: 1,
            protection: 2,
            cost: 3,
            feedback:
              "You might build a nice brand, but rivals can cook very similar chicken. You rely heavily on atmosphere and story to keep customers.",
            concept:
              "Brand helps, but giving away the core recipe makes imitation much easier."
          },
          patentAttempt: {
            label: "Patent the recipe preparation method and all detailed processes",
            tools: "Patents, lawyers, disclosure",
            meta: "You file a patent on the meditation sequence.",
            payoff: -3,
            protection: 2,
            cost: 5,
            feedback:
              "Recipe patents are often narrow or not granted. You would disclose your secret for limited protection and high cost ‚Äì a classic value-destroying move.",
            concept:
              "Mis-matched legal tools (forcing patents on recipes) usually destroy value rather than create it."
          }
        }
      },
      {
        id: 3,
        title: "Streaming service recommendation engine",
        what: "A better algorithm that suggests films and series people actually watch.",
        description:
          "Your mid-size streaming platform, operating across Europe, builds a recommendation system that clearly increases viewing time. Users only see better suggestions on the home screen.",
        imitability:
          "Competitors see the results, not the code. They would need similar data and experts to copy it.",
        visibility:
          "The algorithm is never shipped as a product. Only outputs (recommendations) are visible.",
        assets:
          "User data, software engineers, access to a medium-sized subscriber base.",
        context:
          "Software patents exist but are contested; it is easy to copy general ideas, harder to copy tuned models and data.",
        bestChoiceKey: "secretPlusContracts",
        choices: {
          secretPlusContracts: {
            label: "Treat algorithm as trade secret + tight NDAs + continuous iteration",
            tools: "Secrecy, copyright on code, NDAs, speed",
            meta: "You protect the code, restrict access and run a fast improvement cycle.",
            payoff: 4,
            protection: 4,
            cost: 3,
            feedback:
              "Secrecy plus speed and contracts fits the setting: rivals can guess the idea but not your tuned models and data pipelines.",
            concept:
              "When rivals cannot see the ‚Äòinside‚Äô, secrecy plus speed, supported by contracts, often beats patents."
          },
          patentAndPublish: {
            label: "Patent algorithm methods + publish detailed white papers about it",
            tools: "Software patents, publications, academic signalling, investor relations, PR value",
            meta: "You disclose the approach to get patents and academic prestige, publishing white papers about your methods.",
            payoff: 1,
            protection: 3,
            cost: 4,
            feedback:
              "You might secure some rights and publicity, but you also help competitors learn what to build. Enforcement is costly.",
            concept:
              "In contested software areas, patents may add signalling value but can weaken practical secrecy."
          },
          brandCampaignOnly: {
            label: "Skip technical protection + invest in brand marketing campaigns",
            tools: "Branding, advertising, trade marks, customer acquisition, marketing campaigns",
            meta: "You treat the algorithm as just part of the service and invest heavily in brand marketing instead.",
            payoff: -2,
            protection: 1,
            cost: 3,
            feedback:
              "Branding helps, but once rivals catch up you have little to stop them. You underuse a hidden technical asset that could have been protected.",
            concept:
              "Ignoring protection for a core technology usually means giving up bargaining power and long-term profits."
          }
        }
      },
      {
        id: 4,
        title: "Stylish meditation app",
        what: "A mobile app with guided audio and a distinctive visual style.",
        description:
          "You launch a meditation app from the UK. The exercises are similar to others, but your visual design, sounds and logo feel distinctive and polished.",
        imitability:
          "Any developer can copy features, but copying exact artwork, logo and audio would be obvious.",
        visibility:
          "Screens, logo and audio are fully visible in app stores and to users worldwide.",
        assets:
          "Design team, sound producers, social media marketing, app store presence.",
        context:
          "Crowded app stores where look, feel and brand help people choose between similar tools.",
        bestChoiceKey: "copyrightTrademarkCommunity",
        choices: {
          copyrightTrademarkCommunity: {
            label: "Copyright visuals/audio + trade marks + community and subscriptions",
            tools: "Copyright, trade marks, community, switching costs",
            meta: "You protect the creative elements and brand, while building user attachment.",
            payoff: 4,
            protection: 4,
            cost: 3,
            feedback:
              "This bundle fits well here. Copyright guards creative assets, trademarks protect brand identity, and subscriptions create user switching costs.",
            concept:
              "Copyright and trade marks protect creative work and identity; switching costs and community create sticky users."
          },
          patentAttempt: {
            label: "Patent the guided meditation process steps and detailed sequence flow",
            tools: "Patents, lawyers, disclosure",
            meta: "You file a patent on the meditation sequence.",
            payoff: -3,
            protection: 1,
            cost: 5,
            feedback:
              "This is a poor fit. Patents on abstract mental processes are usually weak or rejected outright. You spend heavily on legal fees with little practical protection.",
            concept:
              "Patents are often too blunt or expensive for abstract software or business methods."
          },
          secrecyOnly: {
            label: "Keep all visual design elements fully secret until product launches",
            tools: "Secrecy, internal controls",
            meta: "You do not register any IP or formal contracts.",
            payoff: 0,
            protection: 1,
            cost: 1,
            feedback:
              "The design becomes visible instantly on launch. Secrecy provides no lasting protection for visual assets that users must see to experience.",
            concept:
              "If the innovation is fully visible once sold, secrecy is useless."
          }
        }
      },
      {
        id: 5,
        title: "Modular industrial automation robot",
        what: "A new design of robot arm where the tool-head can be rapidly swapped for different tasks.",
        description:
          "You are a start-up in Germany with a breakthrough design for a highly flexible industrial robot. The mechanism is complex and hard to copy without seeing it up close.",
        imitability:
          "The mechanical components are moderately hard to analyse, but the software and configuration skills are the hardest part to copy.",
        visibility:
          "Customers see the robot arm, but not the detailed plans or manufacturing software.",
        assets:
          "Precision manufacturing facilities, robot engineers, service/maintenance network.",
        context:
          "Strong patent system for mechanical devices. Customers demand reliable service and support.",
        bestChoiceKey: "patentComplexityAssets",
        choices: {
          patentComplexityAssets: {
            label: "Mechanism patents + complexity + service contracts",
            tools: "Patents, complexity, service contracts, technical support agreements",
            meta: "You protect hardware via patents and rely on tacit know-how plus dedicated service team.",
            payoff: 5,
            protection: 5,
            cost: 4,
            feedback:
              "This is a strong bundle. Patents protect the physical invention, complexity and service contracts capture the value over the long term, making you indispensable.",
            concept:
              "Combining IP (patents) with complementary assets (service) and tacit knowledge (complexity) is a powerful strategy in hardware."
          },
          openSource: {
            label: "Open source the robot design + focus on service contracts only",
            tools: "Open source, service contracts, community engagement, support",
            meta: "You give away the design and focus on making money from maintenance, support and spare parts.",
            payoff: 2,
            protection: 2,
            cost: 2,
            feedback:
              "This is an alternative strategy but gives up key profit potential. Rivals can use your design and hire their own service teams, or sell compatible parts.",
            concept:
              "Giving away core tech can work for adoption but is risky if complementary assets aren't tightly controlled."
          },
          secrecyOnly: {
            label: "Keep parts and plans secret + sell products without service contracts",
            tools: "Secrecy, internal controls",
            meta: "You do not register any IP or formal contracts.",
            payoff: -1,
            protection: 3,
            cost: 3,
            feedback:
              "Customers in this market need long-term service. Without contracts and support, they will prefer a competitor, even if your robot is better. Secrecy hurts sales.",
            concept:
              "Ignoring essential complementary assets (like service) can destroy commercial value."
          }
        }
      },
      {
        id: 6,
        title: "New, faster process for recycling plastic",
        what: "A new chemical process that breaks down a complex plastic into re-usable material much faster and more cleanly.",
        description:
          "You are a chemical engineering start-up. The process happens inside a reactor on an industrial site. The output product is visible, but the exact temperature and pressure steps are not.",
        imitability:
          "A rival could only copy by guessing the exact parameters and building their own test facility, which is expensive.",
        visibility:
          "The process itself is hidden; only the end product is sold publicly.",
        assets:
          "Specialised chemical engineers, access to pilot facility, contracts with industrial partners for feedstock.",
        context:
          "Patents are possible but can be hard to enforce with internal processes; secrecy is a strong option.",
        bestChoiceKey: "tradeSecretContract",
        choices: {
          tradeSecretContract: {
            label: "Trade secrecy on process + tight NDAs with staff",
            tools: "Secrecy, NDAs, employee contracts",
            meta: "You protect the core process as a secret using contracts with staff.",
            payoff: 4,
            protection: 4,
            cost: 3,
            feedback:
              "This is a great fit. Because the process is internal and hard to observe, trade secrecy is robust and cheaper than a patent fight. Contracts secure the boundaries.",
            concept:
              "When an innovation is an unobservable internal process (like manufacturing), secrecy is often the most effective tool."
          },
          patentOnly: {
            label: "Patent the complete process in full detail for disclosure",
            tools: "Patents, lawyers, public disclosure, technical documentation, filing costs",
            meta: "You file a strong detailed patent making the entire process publicly known, hoping legal protection is enough.",
            payoff: 1,
            protection: 3,
            cost: 4,
            feedback:
              "You gain legal protection, but you disclose your secret. If competitors can tweak their process to evade the patent, you've made their life easier.",
            concept:
              "For process innovation, patents involve a trade-off: legal protection for public disclosure."
          },
          speedOnly: {
            label: "Skip protection mechanisms + build manufacturing capacity fast",
            tools: "Lead time, speed, manufacturing capacity, scale advantages, market presence",
            meta: "You rush to build capacity and rely purely on first-mover advantage and lead time over competitors.",
            payoff: 2,
            protection: 2,
            cost: 3,
            feedback:
              "You gain some short-term profit but rivals can eventually copy your product and process. You leave money on the table by not protecting the core asset.",
            concept:
              "Speed alone is rarely a long-term defense against determined and well-resourced competitors."
          }
        }
      },
      {
        id: 7,
        title: "Platform for creating personalised children‚Äôs books",
        what: "A web platform that uses an AI engine and art assets to create and print a unique storybook for a single child (with their name, town, etc.).",
        description:
          "You have a unique business model and highly distinct art style. The AI logic is simple but the combination of art, print, and personalised delivery is new.",
        imitability:
          "The web interface and books are visible. The AI/logic is hidden but not complex. The key difficulty for rivals is logistics and getting high-quality print assets.",
        visibility:
          "Web interface, the final printed book, and the business model are visible.",
        assets:
          "Print-on-demand logistics, unique artist contracts, established distribution channels.",
        context:
          "Copyright protects the art and text. Trademark protects the brand. Patents are unlikely for the simple AI/business method.",
        bestChoiceKey: "copyrightAssetsTrademark",
        choices: {
          copyrightAssetsTrademark: {
            label: "Copyright on art/text + trade marks + exclusive logistics deals",
            tools: "Copyright, trade marks, complementary assets",
            meta: "You protect creative assets and lock down printing and distribution.",
            payoff: 5,
            protection: 5,
            cost: 4,
            feedback:
              "This captures value well. The value lies in logistics/printing (assets) and brand/art (IP). The simple AI is not the main barrier here.",
            concept:
              "A business model based on complementary assets (logistics, printing) requires contracts to secure those assets."
          },
          secrecyOnly: {
            label: "Keep business model and logistics arrangements fully secret",
            tools: "Secrecy, internal controls",
            meta: "You do not register any IP or formal contracts.",
            payoff: -1,
            protection: 1,
            cost: 1,
            feedback:
              "The business model is obvious once you sell one book. Rivals can replicate the simple logic. You're exposed to copycats and lose asset value.",
            concept:
              "Business models are often transparent and cannot be protected by secrecy alone."
          },
          patentOnLogic: {
            label: "Patent the personalisation algorithms and generation logic",
            tools: "Patents, lawyers, disclosure",
            meta: "You try to patent the personalisation process.",
            payoff: 0,
            protection: 2,
            cost: 5,
            feedback:
              "The logic is simple and abstract, making the patent weak. You waste significant capital on an easily circumvented and weak legal tool.",
            concept:
              "Weak patents on abstract ideas are expensive distractions when the value lies elsewhere."
          }
        }
      },
      {
        id: 8,
        title: "A new design of high-end consumer speaker (audio)",
        what: "A new design of speaker cabinet that significantly improves sound quality and looks very distinctive.",
        description:
          "You are a luxury audio company. The design is novel and beautiful. The component parts are mostly standard, but the cabinet construction is unique.",
        imitability:
          "Easy to open up and copy the design and components once sold. The main barrier to rivals is the skilled assembly required.",
        visibility:
          "The speaker is fully visible on sale. The complex assembly process is hidden.",
        assets:
          "Highly skilled assembly team, unique manufacturing processes, strong brand reputation.",
        context:
          "Patents are possible on the cabinet design. Brand is very important in the luxury audio market.",
        bestChoiceKey: "designPatentTrademarkComplexity",
        choices: {
          designPatentTrademarkComplexity: {
            label: "Design patents + trade marks + complexity in assembly",
            tools: "Design IP/Patents, trade marks, complexity, tacit assembly skill",
            meta: "You protect the shape, brand, and rely on tacit assembly know-how that is difficult to copy.",
            payoff: 4,
            protection: 4,
            cost: 3,
            feedback:
              "This is a strong bundle. Design patents protect the cabinet shape, trademarks build brand recognition, and tacit assembly skill creates a barrier to imitation.",
            concept:
              "Combining design IP (protecting visible form) with trade marks (brand) and tacit complexity (hard-to-copy skills) is powerful for premium consumer hardware."
          },
          secrecyOnAssemblyOnly: {
            label: "Keep assembly process as trade secret without any other protections",
            tools: "Secrecy, complexity, internal training, staff retention programmes",
            meta: "You rely entirely on the hidden complexity of the assembly process and keeping staff loyal.",
            payoff: 1,
            protection: 2,
            cost: 1,
            feedback:
              "Rivals can copy the beautiful, visible design and reverse-engineer the components. You lose protection for the most valuable, visible parts of the product.",
            concept:
              "If the value lies in a visible feature, secrecy on a process is insufficient."
          },
          utilityPatentOnly: {
            label: "File standard utility patent on the sound improvement technology only",
            tools: "Patents (utility), lawyers, technical documentation and disclosure",
            meta: "You file a utility patent focused on the technical acoustics, ignoring design and brand.",
            payoff: 2,
            protection: 3,
            cost: 3,
            feedback:
              "This provides some protection but is incomplete. The product's value is heavily tied to its visible design and luxury brand, which you leave unprotected.",
            concept:
              "Appropriation strategy must match where the value is actually created (in this case, in both function and form)."
          }
        }
      },
      {
        id: 9,
        title: "Web application for managing personal tax returns",
        what: "A new, highly usable software service that guides small business owners through their annual tax returns.",
        description:
          "You have a new design for the user interface and a clear, simple workflow. The underlying tax rules and calculations are public and available to all competitors.",
        imitability:
          "Easy to copy the 'idea' and the calculation logic. Harder to copy the polished user experience and the high number of data integrations required.",
        visibility:
          "The user interface and workflow are fully visible and used by customers.",
        assets:
          "Data integration contracts, relationship with tax authorities, large base of users who are now locked into the system.",
        context:
          "Strong IP on code (copyright) but weak on the 'process' (patents). User lock-in and network effects are key to retention.",
        bestChoiceKey: "copyrightCommunityAssets",
        choices: {
          copyrightCommunityAssets: {
            label: "Copyright on code + community/switching costs + data contracts",
            tools: "Copyright, community, switching costs, contracts",
            meta: "You protect code, build a sticky user base, and secure data access.",
            payoff: 5,
            protection: 5,
            cost: 4,
            feedback:
              "This is a powerful strategy where functionality is copyable. The value is captured by locking in users and controlling data assets and integrations.",
            concept:
              "Software value often shifts from the code (copyright) to data, network effects, and complementary assets (switching costs, contracts)."
          },
          patentOnWorkflow: {
            label: "Patent the workflow sequence steps in the tax prep process",
            tools: "Patents, lawyers, disclosure, filing fees, enforcement costs, legal processes",
            meta: "You file a business method patent on the workflow, trying to block others from your user journey approach.",
            payoff: 0,
            protection: 1,
            cost: 5,
            feedback:
              "Business method patents are often weak, hard to enforce, and expensive. This is an abstract idea that's easily worked around by making small workflow changes.",
            concept:
              "Using a high-cost, weak legal tool for a simple, copyable abstract idea is a net loss."
          },
          tradeSecretOnInterface: {
            label: "Keep the user interface design secret until product launches",
            tools: "Secrecy, basic app presence, internal design controls, NDA agreements",
            meta: "You focus on NDAs and security to protect the UI design until launch day, keeping everything internal.",
            payoff: -1,
            protection: 1,
            cost: 1,
            feedback:
              "The interface is immediately and fully visible to everyone upon first use. Secrecy is a useless tool for protecting any public-facing software elements.",
            concept:
              "Secrecy is only valuable when the innovation is not visible externally."
          }
        }
      },
      {
        id: 10,
        title: "A popular new toy design for young children",
        what: "A simple, soft-plastic toy with a new shape and colour scheme that is hugely popular for toddlers.",
        description:
          "You are a small toy design firm. The toy is simple to manufacture, but the specific shape and colours are the source of its popularity. It is easy to reverse-engineer.",
        imitability:
          "Simple to copy the components and shape. Harder to copy the exact colour and material feel (tacit skill) and the brand awareness.",
        visibility:
          "The product is fully visible and sold in retail stores.",
        assets:
          "Brand name, manufacturing contracts, distribution channels in major retail stores.",
        context:
          "Design IP and trademarks are crucial here. Speed to market is also important to build brand before imitators arrive.",
        bestChoiceKey: "designIPTrademarkSpeed",
        choices: {
          designIPTrademarkSpeed: {
            label: "Design IP on shape/colours + trade mark + speed to market",
            tools: "Design IP/Copyright, trade marks, lead time, speed",
            meta: "You protect aesthetics and use speed and distribution to beat copycats.",
            payoff: 5,
            protection: 5,
            cost: 4,
            feedback:
              "This is a comprehensive approach: protect the IP that matters most (design/brand) and secure market position through speed and distribution.",
            concept:
              "For consumer goods, brand and design IP (trademark/copyright/design rights) are the most effective appropriability tools."
          },
          patentOnPlastic: {
            label: "Patent the specific plastic mixture used in the toy materials",
            tools: "Patents, lawyers, disclosure, technical documentation, materials analysis",
            meta: "You file a patent on the exact polymer mixture used, hoping material composition provides protection.",
            payoff: 1,
            protection: 2,
            cost: 4,
            feedback:
              "The real value is in the aesthetic and brand, not the material. Rivals can easily tweak their plastic blend while still copying the popular shape and colours.",
            concept:
              "Protecting a secondary feature while leaving the primary source of value (design/brand) open is a flawed strategy."
          },
          secrecyOnDesign: {
            label: "Keep the toy shape secret with NDAs until the product launches",
            tools: "Secrecy, internal controls, NDA agreements, staff confidentiality, launch planning",
            meta: "You rely on NDAs and secrecy until the product hits shelves, keeping the design completely internal.",
            payoff: -2,
            protection: 1,
            cost: 1,
            feedback:
              "Once sold, the shape is instantly visible and easily reverse-engineered. You lost time and failed to secure any enforceable, lasting protection.",
            concept:
              "Secrecy is ineffective for physical, visible products."
          }
        }
      },
      {
        id: 11,
        title: "Novel gene therapy for rare disease",
        what: "A breakthrough treatment that modifies patient cells to correct a genetic defect causing a rare childhood illness.",
        description:
          "Your biotech start-up has developed a gene therapy that shows remarkable results in clinical trials. The therapy requires specialised manufacturing and clinical delivery expertise.",
        imitability:
          "The underlying science is published, but the specific vector design and manufacturing process are extremely difficult to replicate without years of R&D.",
        visibility:
          "The treatment mechanism is disclosed in regulatory filings and scientific papers.",
        assets:
          "Specialised manufacturing facility, clinical trial data, relationships with rare disease patient groups and specialist hospitals.",
        context:
          "Strong patent protection for biologics. Orphan drug designation provides market exclusivity. Manufacturing know-how is critical.",
        bestChoiceKey: "patentOrphanManufacturing",
        choices: {
          patentOrphanManufacturing: {
            label: "Patents on vector + orphan drug status + manufacturing partners",
            tools: "Patents, regulatory exclusivity, manufacturing contracts, partnerships",
            meta: "You secure IP, leverage regulatory incentives, and partner with specialist manufacturers.",
            payoff: 5,
            protection: 5,
            cost: 4,
            feedback:
              "This combines multiple layers of protection. Patents cover the innovation, orphan drug status adds regulatory exclusivity, and partnerships secure manufacturing.",
            concept:
              "In biotech, layering patents with regulatory exclusivity and manufacturing control creates powerful, multi-layered protection."
          },
          patentOnly: {
            label: "File broad patents + try to manufacture all products in-house",
            tools: "Patents, lawyers, public disclosure, technical documentation, filing costs",
            meta: "You file a strong detailed patent making the entire process publicly known, hoping legal protection is enough.",
            payoff: 1,
            protection: 3,
            cost: 5,
            feedback:
              "Building specialised biologics manufacturing is extremely expensive and slow. You may have strong patents but lack the capacity to deliver therapy at scale.",
            concept:
              "Even strong patents fail without access to essential complementary assets like specialised manufacturing."
          },
          secrecyOnProcess: {
            label: "Keep manufacturing secret + file only narrow patent claims",
            tools: "Secrecy, trade secrets, limited patents, manufacturing know-how",
            meta: "You treat manufacturing know-how as a trade secret and file only narrow patent claims.",
            payoff: 2,
            protection: 3,
            cost: 2,
            feedback:
              "Secrecy on manufacturing has value, but regulatory filings require significant disclosure. You miss out on full protection patents could provide for the vector design.",
            concept:
              "In highly regulated industries, mandatory disclosure limits the effectiveness of secrecy strategies."
          }
        }
      },
      {
        id: 12,
        title: "Distinctive luxury handbag design",
        what: "A new handbag with a unique closure mechanism and iconic shape that is becoming a status symbol.",
        description:
          "Your fashion house has created a handbag that celebrities are carrying. The distinctive clasp and silhouette are instantly recognisable. Counterfeiters are already attempting copies.",
        imitability:
          "The shape and clasp are visible and can be copied, but exact replication of materials and craftsmanship is difficult.",
        visibility:
          "Fully visible product. The design is photographed constantly on social media.",
        assets:
          "Brand heritage, flagship retail stores, relationships with fashion media, skilled artisan workforce.",
        context:
          "Design rights, trade marks, and trade dress are key. Anti-counterfeiting enforcement matters. Brand perception drives most of the value.",
        bestChoiceKey: "designTrademarkEnforcement",
        choices: {
          designTrademarkEnforcement: {
            label: "Design rights + clasp trade mark + anti-counterfeiting programme",
            tools: "Design IP, trade marks, trade dress, enforcement",
            meta: "You register the design, trademark the clasp, and pursue counterfeiters.",
            payoff: 5,
            protection: 5,
            cost: 4,
            feedback:
              "This is the luxury playbook. Multiple overlapping IP rights plus active enforcement protect against counterfeits, while brand investment maintains value.",
            concept:
              "Luxury goods require layered IP protection (design + trademark + trade dress) combined with active enforcement and brand investment."
          },
          patentOnClasp: {
            label: "File utility patent on the clasp mechanism and overall design",
            tools: "Patents, lawyers",
            meta: "You file a mechanical patent on the clasp.",
            payoff: 2,
            protection: 3,
            cost: 4,
            feedback:
              "A utility patent might help, but the value is in the aesthetic and brand, not the mechanism. Counterfeiters can modify the mechanism while copying the look.",
            concept:
              "For fashion items, design rights and trademarks typically matter more than utility patents."
          },
          brandOnlyNoEnforcement: {
            label: "Focus only on brand marketing + ignore all counterfeit products",
            tools: "Brand, marketing, trade marks",
            meta: "You invest in marketing without pursuing copycats.",
            payoff: 0,
            protection: 2,
            cost: 3,
            feedback:
              "Without enforcement, counterfeits flood the market and dilute your brand. The aspirational value erodes as cheap fakes become ubiquitous in the marketplace.",
            concept:
              "IP rights without enforcement are merely paper shields. Active enforcement is essential for brand protection."
          }
        }
      },
      {
        id: 13,
        title: "Craft brewery's signature beer recipe",
        what: "A unique IPA with a distinctive hop blend and brewing process that has won awards and developed a cult following.",
        description:
          "Your small craft brewery has created a beer that beer enthusiasts travel to try. The recipe involves a specific combination of hops and a unique dry-hopping schedule.",
        imitability:
          "Competitors can taste the beer and guess at ingredients, but replicating the exact flavour profile requires knowing the precise recipe and process.",
        visibility:
          "The final product is consumed, but the recipe and process are hidden in the brewery.",
        assets:
          "Taproom and local distribution, loyal customer community, relationships with hop suppliers, brewing expertise.",
        context:
          "Recipes cannot be patented. Trade secrets and brand loyalty are the main protection. Craft beer consumers value authenticity.",
        bestChoiceKey: "secrecyBrandCommunity",
        choices: {
          secrecyBrandCommunity: {
            label: "Trade secret on recipe + brand story + community + contracts",
            tools: "Secrecy, trade marks, community, contracts",
            meta: "You protect the recipe, build an authentic brand, and engage your community.",
            payoff: 4,
            protection: 4,
            cost: 3,
            feedback:
              "This matches the craft beer context. Secrecy protects the recipe, brand and community create loyalty, and supplier relationships secure key inputs.",
            concept:
              "When legal IP is weak (recipes can't be patented), secrecy combined with brand authenticity and community creates durable competitive advantage."
          },
          publishRecipeForPR: {
            label: "Publish recipe publicly to generate press and show authenticity",
            tools: "Transparency, PR, brand",
            meta: "You release the full recipe as a marketing stunt.",
            payoff: 0,
            protection: 1,
            cost: 2,
            feedback:
              "You get short-term publicity but enable any competitor to brew a very similar beer. You've effectively given away your core differentiation for free.",
            concept:
              "Transparency can build trust, but giving away easily replicable trade secrets destroys competitive advantage."
          },
          expandAggressively: {
            label: "Skip all protection + focus on rapid national market expansion",
            tools: "Speed, distribution, scale",
            meta: "You license production to scale up quickly.",
            payoff: 1,
            protection: 1,
            cost: 3,
            feedback:
              "Rapid expansion dilutes quality control and authenticity. Your recipe leaks through partner breweries, and the brand loses its original craft credibility.",
            concept:
              "Scaling too fast without protecting core assets can destroy both quality and competitive advantage."
          }
        }
      },
      {
        id: 14,
        title: "Advanced concrete mixture for extreme climates",
        what: "A new concrete formulation that remains stable in extreme temperature swings, ideal for infrastructure in harsh environments.",
        description:
          "Your construction materials company has developed a concrete mix that outperforms competitors in arctic and desert conditions. The formula involves specific additives and curing processes.",
        imitability:
          "Competitors can test samples but replicating the exact formulation and process requires significant R&D. The real complexity is in the curing process.",
        visibility:
          "The finished concrete is visible in structures, but the formulation and process are hidden.",
        assets:
          "Materials science expertise, testing facilities, relationships with major construction firms, supply chain for rare additives.",
        context:
          "Patents on chemical compositions are possible but can be designed around. Process know-how and customer relationships are crucial.",
        bestChoiceKey: "patentSecrecyContracts",
        choices: {
          patentSecrecyContracts: {
            label: "Patent formulation + trade secret curing + long-term contracts",
            tools: "Patents, secrecy, contracts, supply chain control, customer lock-in",
            meta: "You patent the formulation, keep curing secret, and lock in customers with long-term deals.",
            payoff: 5,
            protection: 5,
            cost: 4,
            feedback:
              "This layered approach works well. Patents provide baseline protection, secrecy guards the hardest-to-copy elements, and contracts secure revenue streams.",
            concept:
              "Combining patents (for disclosed elements) with trade secrets (for hidden processes) creates stronger protection than either alone."
          },
          fullPatentDisclosure: {
            label: "File comprehensive patents disclosing both formula and process",
            tools: "Patents, full disclosure, comprehensive documentation requirements",
            meta: "You seek maximum patent coverage by disclosing everything in detail to competitors.",
            payoff: 2,
            protection: 3,
            cost: 4,
            feedback:
              "Full disclosure helps competitors understand your process. While you have legal protection, enforcement is expensive and rivals can design around specific claims.",
            concept:
              "Over-disclosure in patents can help competitors more than it protects you, especially for process innovations."
          },
          secrecyOnly: {
            label: "Keep all information as trade secrets + skip patents entirely",
            tools: "Secrecy, internal controls",
            meta: "You do not register any IP or formal contracts.",
            payoff: 2,
            protection: 3,
            cost: 2,
            feedback:
              "Secrecy works for the process, but competitors can analyse your concrete samples and may independently develop similar formulations without legal consequence.",
            concept:
              "Pure secrecy strategies are vulnerable to independent discovery and reverse engineering."
          }
        }
      },
      {
        id: 15,
        title: "Interactive online learning platform for professional skills",
        what: "A platform that uses AI to create personalised learning paths and interactive simulations for business professionals.",
        description:
          "Your edtech start-up has built a platform where professionals learn through AI-generated scenarios and peer interaction. The content library and AI matching algorithm are key.",
        imitability:
          "The platform concept is visible, but the AI models trained on user data and the extensive content library are hard to replicate quickly.",
        visibility:
          "Users experience the interface and content. The AI logic and training data are hidden.",
        assets:
          "Content library, user data, corporate training partnerships, instructional design team.",
        context:
          "Software patents are weak. Copyright protects content. Network effects and data advantages create moats. Corporate contracts provide stable revenue.",
        bestChoiceKey: "copyrightDataContracts",
        choices: {
          copyrightDataContracts: {
            label: "Copyright on content + data moat + long-term corporate deals",
            tools: "Copyright, data assets, network effects, contracts",
            meta: "You protect content, improve AI with data, and sign enterprise deals.",
            payoff: 5,
            protection: 4,
            cost: 3,
            feedback:
              "This creates a flywheel: content attracts users, user data improves AI, better AI attracts corporate clients who sign long-term deals.",
            concept:
              "In digital platforms, data network effects and contractual lock-in often matter more than traditional IP protection."
          },
          patentOnAI: {
            label: "File patents on the AI personalisation algorithm methods",
            tools: "Patents, lawyers, disclosure, filing fees, technical documentation requirements",
            meta: "You invest heavily in patenting your AI matching algorithms, seeking broad legal protection.",
            payoff: 1,
            protection: 2,
            cost: 5,
            feedback:
              "AI/ML patents are difficult to enforce and easy to design around. You've spent significant resources on weak protection while neglecting stronger moats.",
            concept:
              "Software and AI patents are often weaker than data advantages and network effects."
          },
          openContentModel: {
            label: "Make all content free and open + monetise via certifications",
            tools: "Open content, certification revenue, freemium approach, credential offerings",
            meta: "You release all learning content freely and charge only for certificates and professional credentials.",
            payoff: 0,
            protection: 1,
            cost: 2,
            feedback:
              "Open content can drive adoption but competitors can copy your model. Without proprietary content or data advantages, you're easily replicated by others.",
            concept:
              "Open models require alternative moats (brand, network effects, data) to prevent commoditisation."
          }
        }
      },
      {
        id: 16,
        title: "Precision agriculture drone system",
        what: "A drone system that uses multispectral imaging and AI to identify crop diseases before they're visible to farmers.",
        description:
          "Your agtech company has developed drones with custom sensors and AI analysis software that can detect crop stress weeks before human observation. Early detection saves farmers significant losses.",
        imitability:
          "The hardware uses mostly standard components, but the sensor calibration and AI disease detection models are trained on years of field data.",
        visibility:
          "The drone hardware is visible. The AI models and training data are hidden in the cloud.",
        assets:
          "Proprietary training datasets, agronomist expertise, relationships with large farming cooperatives, drone service network.",
        context:
          "Hardware patents are possible but drones are commoditising. Data and AI models are the real advantage. Farmers value reliability and local service.",
        bestChoiceKey: "dataAIServiceContracts",
        choices: {
          dataAIServiceContracts: {
            label: "Proprietary AI models + data partnerships + service",
            tools: "Trade secrets (AI/data), contracts, service",
            meta: "You protect models/data, sign exclusive deals, and provide full-service.",
            payoff: 5,
            protection: 5,
            cost: 4,
            feedback:
              "The value is in the data and models, not the drones. Exclusive data partnerships create a growing advantage, while service contracts lock in customers.",
            concept:
              "When hardware commoditises, data assets, trained AI models, and service relationships become the key sources of competitive advantage."
          },
          patentDroneHardware: {
            label: "Patent the drone hardware design and all sensor arrangements",
            tools: "Patents, hardware",
            meta: "You file patents on the drone configuration.",
            payoff: 1,
            protection: 2,
            cost: 4,
            feedback:
              "Drone hardware is rapidly commoditising. Your patents cover the least valuable and most easily substituted part of the overall system and offering.",
            concept:
              "Patenting commoditising hardware while ignoring data and AI advantages is a strategic mismatch."
          },
          sellHardwareOnly: {
            label: "Sell drones as hardware products only without any service deals",
            tools: "Hardware sales, warranty",
            meta: "You sell drones as one-time purchases.",
            payoff: 0,
            protection: 1,
            cost: 2,
            feedback:
              "Without the AI analysis service, you're selling commodity hardware. You also lose access to the field data that could improve your models over time.",
            concept:
              "In AI-driven products, ongoing service relationships capture more value than one-time hardware sales."
          }
        }
      },
      {
        id: 17,
        title: "Enterprise cybersecurity threat detection platform",
        what: "A security platform that uses behavioural analysis to detect insider threats and advanced persistent threats in corporate networks.",
        description:
          "Your cybersecurity firm has built a platform that detects sophisticated attacks by analysing patterns across network traffic, user behaviour, and system logs. Large enterprises are your target customers.",
        imitability:
          "The detection algorithms are hidden, but the general approach is known in the industry. The key advantage is your threat intelligence database built from years of deployments.",
        visibility:
          "Customers see alerts and dashboards. The detection logic and threat database are hidden.",
        assets:
          "Threat intelligence database, security researcher team, relationships with CISOs at major enterprises, 24/7 security operations centre.",
        context:
          "Cybersecurity buyers value trust and track record. Threat intelligence is perishable and must be continuously updated. Long sales cycles but sticky customers.",
        bestChoiceKey: "threatIntelContractsCommunity",
        choices: {
          threatIntelContractsCommunity: {
            label: "Threat intelligence + multi-year contracts + community",
            tools: "Trade secrets, contracts, complementary assets, community credibility",
            meta: "You protect threat intel, sign long-term deals, and build credibility through community.",
            payoff: 5,
            protection: 5,
            cost: 4,
            feedback:
              "Trust and track record are everything here. Your threat intelligence creates a data moat, contracts ensure revenue stability, and community builds credibility.",
            concept:
              "In enterprise security, proprietary threat intelligence combined with trust-based relationships creates sustainable competitive advantage."
          },
          patentDetectionMethods: {
            label: "Patent the behavioural detection algorithms and all methods",
            tools: "Patents, disclosure, technical documentation, public filing required",
            meta: "You file detailed patents on your detection methodologies for legal protection.",
            payoff: 1,
            protection: 2,
            cost: 4,
            feedback:
              "Patent filings disclose your detection methods to the very adversaries you're trying to catch. Attackers can study your patents to evade your detection systems.",
            concept:
              "In security, disclosure through patents can directly benefit adversaries‚Äîsecrecy is often strategically superior."
          },
          openSourceCore: {
            label: "Open source the detection engine + sell enterprise support contracts",
            tools: "Open source, support contracts, community engagement, enterprise deals",
            meta: "You release the core platform as open source and monetise through enterprise support.",
            payoff: 2,
            protection: 2,
            cost: 2,
            feedback:
              "Open source can drive adoption but you give away detection logic. Your threat intelligence database remains proprietary, but you've weakened overall positioning.",
            concept:
              "Open source strategies work best when the open component is not the primary source of competitive advantage."
          }
        }
      },
      {
        id: 18,
        title: "Implantable glucose monitor for diabetics",
        what: "A tiny sensor implanted under the skin that continuously monitors blood glucose and transmits readings to a smartphone app.",
        description:
          "Your medical device company has developed an implantable sensor that lasts 6 months, far longer than existing stick-on monitors. The biocompatible coating and miniaturised electronics are breakthroughs.",
        imitability:
          "The device is small and difficult to reverse-engineer without destroying it. The coating chemistry and manufacturing precision are extremely hard to replicate.",
        visibility:
          "The implanted device is invisible. Regulatory filings disclose some technical details.",
        assets:
          "FDA/CE approval, clinical validation data, relationships with endocrinologists, specialised manufacturing facility.",
        context:
          "Medical device patents are strong and enforceable. Regulatory approval is a significant barrier. Physician relationships drive adoption.",
        bestChoiceKey: "patentRegulatoryAssets",
        choices: {
          patentRegulatoryAssets: {
            label: "Comprehensive patents + regulatory exclusivity + education",
            tools: "Patents, regulatory approval, physician relationships",
            meta: "You build a patent portfolio, leverage regulatory barriers, and educate physicians.",
            payoff: 5,
            protection: 5,
            cost: 4,
            feedback:
              "Medical devices benefit from strong, enforceable patents. Combined with regulatory barriers and physician relationships, you create formidable protection.",
            concept:
              "Medical devices are one of the few sectors where patents provide strong, enforceable protection‚Äîespecially combined with regulatory barriers."
          },
          secrecyOnCoating: {
            label: "Keep the biocompatible coating technology as a trade secret",
            tools: "Secrecy, limited patents",
            meta: "You keep the coating chemistry secret.",
            payoff: 2,
            protection: 3,
            cost: 3,
            feedback:
              "The coating may be analysed by competitors with advanced techniques. Without patent protection, you have no legal recourse if they successfully replicate it.",
            concept:
              "For physical products that must be sold, trade secrets are vulnerable to reverse engineering‚Äîpatents provide stronger protection."
          },
          fastFollowerStrategy: {
            label: "Skip patents + focus on speed to market + rapid iterations",
            tools: "Speed, lead time, iteration",
            meta: "You try to win through faster innovation cycles.",
            payoff: 0,
            protection: 1,
            cost: 2,
            feedback:
              "Medical device development cycles are long due to regulatory requirements. Without patents, larger competitors with more resources will eventually overtake you.",
            concept:
              "In regulated industries with long development cycles, speed alone is insufficient without IP protection."
          }
        }
      },
      {
        id: 19,
        title: "Competitive esports team management platform",
        what: "A platform that helps esports organisations manage player contracts, analyse performance data, and coordinate training schedules.",
        description:
          "Your start-up has built software used by several top esports teams. The platform integrates with game APIs to provide unique performance analytics and helps manage complex multi-game rosters.",
        imitability:
          "The platform concept is straightforward, but your game API integrations and analytics models are built on relationships and proprietary data.",
        visibility:
          "Teams see the interface. Analytics models and data pipelines are hidden.",
        assets:
          "Relationships with game publishers for API access, performance data from partner teams, esports industry expertise.",
        context:
          "Software patents are weak. API access depends on publisher relationships. Esports is a small, relationship-driven industry where reputation matters.",
        bestChoiceKey: "apiDataContracts",
        choices: {
          apiDataContracts: {
            label: "Exclusive API partnerships + performance data + contracts",
            tools: "Contracts, data assets, publisher relationships",
            meta: "You secure API access, build datasets, and align incentives through sharing.",
            payoff: 4,
            protection: 4,
            cost: 3,
            feedback:
              "In esports, relationships and data access are everything. Exclusive API partnerships and proprietary team data create barriers that software features alone cannot.",
            concept:
              "In relationship-driven niche industries, contractual exclusivity and data access often matter more than product features or traditional IP."
          },
          patentAnalytics: {
            label: "Patent the performance analytics methodologies and statistical models",
            tools: "Patents, lawyers, disclosure",
            meta: "You file patents on your analysis methods.",
            payoff: 0,
            protection: 1,
            cost: 4,
            feedback:
              "Analytics methodology patents are weak and easily designed around. You've wasted resources on unenforceable protection while neglecting relationship-building.",
            concept:
              "Patents on analytical methods are typically weak‚Äîfocus resources on building moats that actually work in your industry."
          },
          freemiumGrowth: {
            label: "Offer free tier to all teams + monetise with premium features only",
            tools: "Freemium model, scale",
            meta: "You prioritise user acquisition with a free tier.",
            payoff: 1,
            protection: 1,
            cost: 2,
            feedback:
              "Free access doesn't build data moats if free users don't share data. You commoditise your product while failing to lock in the relationships and data that matter.",
            concept:
              "Freemium models work when free usage generates network effects or data‚Äîotherwise they just commoditise your offering."
          }
        }
      },
      {
        id: 20,
        title: "High-efficiency solar panel coating",
        what: "A nano-coating that increases solar panel efficiency by 15% and can be applied to existing installations.",
        description:
          "Your cleantech company has developed a spray-on coating that significantly boosts solar panel output. The coating's nano-structure is the key innovation, developed through years of materials research.",
        imitability:
          "The coating can be analysed with electron microscopy, but reproducing the exact nano-structure requires specialised equipment and expertise.",
        visibility:
          "The coating is visible (slightly changes panel appearance). The manufacturing process is hidden.",
        assets:
          "Materials science team, specialised manufacturing equipment, relationships with solar installers and panel manufacturers.",
        context:
          "Strong patents possible on novel materials. Cleantech investors value IP portfolios. Manufacturing partnerships are key to scale.",
        bestChoiceKey: "patentManufacturingPartnership",
        choices: {
          patentManufacturingPartnership: {
            label: "Patents on nano-structure + trade secret process + licensing",
            tools: "Patents, secrecy, licensing contracts, manufacturing partnerships",
            meta: "You patent the composition, keep manufacturing secret, and license to established players.",
            payoff: 5,
            protection: 5,
            cost: 4,
            feedback:
              "This captures value at multiple points: patents protect the innovation, manufacturing secrecy maintains quality control, and licensing leverages others' complementary assets.",
            concept:
              "For physical products with complex manufacturing, combining patents (composition) with trade secrets (process) and licensing maximises value capture."
          },
          verticalIntegration: {
            label: "Build your own complete manufacturing and full installation network",
            tools: "Patents, internal manufacturing, direct sales, full value chain control",
            meta: "You try to capture the entire value chain from coating production to installation.",
            payoff: 1,
            protection: 3,
            cost: 5,
            feedback:
              "Building manufacturing and installation networks requires massive capital and diverts focus from your core innovation. Established players can outcompete you on execution.",
            concept:
              "Vertical integration is capital-intensive and risky when your core advantage is in innovation, not operations."
          },
          tradeSecretOnly: {
            label: "Skip all patents + rely entirely on manufacturing secrecy alone",
            tools: "Secrecy, basic manufacturing assets, internal distribution, factory security",
            meta: "You avoid patent and branding costs and rely on factory secrecy hoping competitors cannot replicate your formula.",
            payoff: 2,
            protection: 3,
            cost: 2,
            feedback:
              "Advanced materials can be reverse-engineered with sophisticated analysis. Without patents, you have no legal recourse when competitors eventually crack it.",
            concept:
              "For analysable physical products, patents provide legal recourse that trade secrets alone cannot."
          }
        }
      },
      {
        id: 21,
        title: "AI-powered legal document review service",
        what: "A service that uses machine learning to review contracts and flag risks, reducing the time lawyers spend on document review by 80%.",
        description:
          "Your legaltech company has trained ML models on millions of contracts to identify problematic clauses. Law firms use your service for due diligence and contract review.",
        imitability:
          "The general approach is known, but your models are trained on proprietary datasets from law firm partnerships that competitors cannot access.",
        visibility:
          "Clients see the interface and results. Models and training data are hidden.",
        assets:
          "Proprietary training data from law firm partners, legal domain experts, relationships with major law firms, reputation for accuracy.",
        context:
          "Legal industry is conservative and values reputation. Data partnerships are key. Software patents are weak but trade secrets are strong.",
        bestChoiceKey: "dataPartnershipsReputation",
        choices: {
          dataPartnershipsReputation: {
            label: "Data partnerships with law firms + reputation + SLAs",
            tools: "Trade secrets, contracts, reputation",
            meta: "You secure exclusive data access, build reputation, and offer guarantees.",
            payoff: 5,
            protection: 5,
            cost: 4,
            feedback:
              "In legal services, trust and accuracy are paramount. Exclusive data access creates an insurmountable training advantage while reputation builds client confidence.",
            concept:
              "In professional services, proprietary training data combined with reputation creates sustainable competitive advantage."
          },
          patentMLMethods: {
            label: "Patent the machine learning methodologies for legal document work",
            tools: "Patents, disclosure",
            meta: "You file patents on your algorithms.",
            payoff: 1,
            protection: 2,
            cost: 4,
            feedback:
              "ML methodology patents are weak and easily designed around. Your real advantage‚Äîthe proprietary training data‚Äîcannot be patented and remains unprotected here.",
            concept:
              "Patents on ML methods are typically weak‚Äîthe real moat is usually in proprietary training data."
          },
          lowCostLeader: {
            label: "Compete on price as a no-frills cheaper alternative service offering",
            tools: "Price competition, efficiency",
            meta: "You undercut competitors on price.",
            payoff: 0,
            protection: 1,
            cost: 2,
            feedback:
              "Law firms value accuracy over cost for risk-sensitive work. Price competition attracts the least valuable clients and invites a damaging race to the bottom.",
            concept:
              "In professional services where errors are costly, competing primarily on price signals low quality and attracts low-value clients."
          }
        }
      },
      {
        id: 22,
        title: "Smart home energy management system",
        what: "A system that optimises home energy usage by coordinating solar panels, batteries, EV charging, and appliances based on electricity prices and weather.",
        description:
          "Your start-up has built a hub that connects to various home devices and makes intelligent decisions about when to store, use, or sell energy back to the grid.",
        imitability:
          "The hardware is straightforward. The value is in the algorithms that predict prices and optimise across devices, trained on data from thousands of homes.",
        visibility:
          "The hub and app are visible. Optimisation algorithms and aggregated data are hidden.",
        assets:
          "Installed base of homes providing data, relationships with utilities, integrations with solar/battery/EV manufacturers.",
        context:
          "Hardware is commoditising. Data network effects and utility partnerships are key. Consumers value simplicity and savings.",
        bestChoiceKey: "dataUtilityPartnerships",
        choices: {
          dataUtilityPartnerships: {
            label: "Proprietary data + utility partnerships + device integrations",
            tools: "Trade secrets, contracts, device integrations",
            meta: "You protect data/algorithms, partner with utilities, and integrate devices.",
            payoff: 5,
            protection: 5,
            cost: 4,
            feedback:
              "More homes provide better data, better data improves optimisation, better optimisation attracts more homes. Utility partnerships add revenue and lock-in.",
            concept:
              "In smart home/IoT, data network effects and ecosystem partnerships create stronger moats than hardware or software IP."
          },
          patentHardwareDesign: {
            label: "Patent the hub hardware design and all physical components",
            tools: "Patents, hardware",
            meta: "You file patents on the hub design.",
            payoff: 1,
            protection: 2,
            cost: 4,
            feedback:
              "The hub hardware is simple and commoditising. Patents protect the least valuable component while your real advantage in data and algorithms remains unexploited.",
            concept:
              "Don't patent commoditising hardware when your real advantage lies elsewhere."
          },
          directToConsumer: {
            label: "Sell hardware direct to consumers + skip utility partners",
            tools: "Hardware sales, direct marketing",
            meta: "You sell direct and avoid utility relationships.",
            payoff: 1,
            protection: 1,
            cost: 3,
            feedback:
              "Without utility partnerships, you miss grid services revenue and demand response programs. You're essentially selling commodity hardware with no recurring income.",
            concept:
              "Ignoring key ecosystem partners limits both protection and monetisation opportunities."
          }
        }
      },
      {
        id: 23,
        title: "Revolutionary battery chemistry for EVs",
        what: "A new solid-state battery that doubles energy density while reducing charging time to 10 minutes.",
        description:
          "Your battery start-up has achieved a breakthrough in solid-state electrolyte technology. The battery requires novel manufacturing processes and materials supply chains.",
        imitability:
          "The chemistry can be analysed, but the manufacturing precision required is extreme. Few facilities in the world could attempt production.",
        visibility:
          "The battery is a physical product. Performance is visible; exact composition requires analysis.",
        assets:
          "Materials science team, pilot manufacturing line, relationships with EV manufacturers and raw materials suppliers.",
        context:
          "Battery patents are valuable and enforceable. EV market is huge but competitive. Manufacturing scale and supply chain are critical.",
        bestChoiceKey: "patentPortfolioSupplyChain",
        choices: {
          patentPortfolioSupplyChain: {
            label: "Patent portfolio + supply contracts + automaker joint ventures",
            tools: "Patents, contracts, complementary assets, supply chain agreements",
            meta: "You build a patent portfolio, lock in suppliers, and partner with major automakers.",
            payoff: 5,
            protection: 5,
            cost: 5,
            feedback:
              "In battery technology, patents are strong and valuable. Combined with supply chain control and automaker partnerships, you create an extremely defensible position.",
            concept:
              "Breakthrough hardware with complex manufacturing benefits from broad patent portfolios combined with supply chain and manufacturing partnerships."
          },
          licensingOnly: {
            label: "License the technology broadly to all interested parties",
            tools: "Patents, licensing, broad access for interested manufacturers",
            meta: "You patent the chemistry and license it non-exclusively to any interested manufacturer.",
            payoff: 2,
            protection: 3,
            cost: 3,
            feedback:
              "Licensing generates revenue but commoditises your innovation. Without supply chain control or manufacturing partnerships, you capture only a fraction of the value created.",
            concept:
              "Broad licensing can generate near-term revenue but may leave significant long-term value on the table."
          },
          secrecyOnManufacturing: {
            label: "Keep manufacturing fully secret + file only minimal patents",
            tools: "Secrecy, complexity, internal manufacturing controls and NDAs",
            meta: "You treat everything as a trade secret and try to maintain a manufacturing monopoly.",
            payoff: 1,
            protection: 2,
            cost: 2,
            feedback:
              "Sophisticated competitors will analyse your batteries and eventually replicate the chemistry. Without patents, you cannot prevent others from manufacturing once they figure it out.",
            concept:
              "For analysable physical products with huge market potential, patents are essential to prevent well-resourced competitors from catching up."
          }
        }
      },
      {
        id: 24,
        title: "Artisan chocolate brand with unique flavour profiles",
        what: "A premium chocolate brand known for unusual flavour combinations and single-origin beans, sold at high-end retailers.",
        description:
          "Your small chocolate company has built a cult following for innovative flavours like miso caramel and smoked chili. The recipes are developed by your head chocolatier.",
        imitability:
          "Flavours can be tasted and approximately copied, but exact replication is difficult. The brand story and packaging are highly distinctive.",
        visibility:
          "Products are fully visible in stores. Recipes are hidden.",
        assets:
          "Head chocolatier's expertise, single-origin supplier relationships, distinctive packaging, placement in premium retailers.",
        context:
          "Food products rely on brand and trade secrets. Design and trademark protection for packaging. Premium positioning depends on perceived authenticity.",
        bestChoiceKey: "brandSecrecyPackaging",
        choices: {
          brandSecrecyPackaging: {
            label: "Trade secrets on recipes + brand story + trade mark package",
            tools: "Secrecy, trade marks, design rights",
            meta: "You protect recipes, build brand narrative, and create recognisable packaging.",
            payoff: 4,
            protection: 4,
            cost: 3,
            feedback:
              "This is the classic premium food playbook. Secrecy protects what can be hidden, brand and packaging protect what's visible, creating perceived value.",
            concept:
              "Premium food brands combine trade secrets (recipes) with strong brand identity (trademarks, design) to create emotional value beyond the physical product."
          },
          massMarketExpansion: {
            label: "Expand to mass-market + license production to manufacturers",
            tools: "Scale, licensing, distribution",
            meta: "You partner with large manufacturers for mass-market.",
            payoff: 1,
            protection: 1,
            cost: 3,
            feedback:
              "Mass-market expansion dilutes premium positioning and risks recipe leakage to partners. You sacrifice margins and authenticity for short-term volume.",
            concept:
              "Premium brands that chase mass-market scale often destroy the exclusivity and authenticity that created their value."
          },
          patentFlavourProcess: {
            label: "Patent the flavour development process and recipe methods",
            tools: "Patents, lawyers, disclosure",
            meta: "You file patents on your flavour development.",
            payoff: -1,
            protection: 1,
            cost: 4,
            feedback:
              "Flavour development processes are either too abstract to patent or too narrow to be useful. You waste money on unsuitable legal tools and disclose trade secrets.",
            concept:
              "Not every business needs patents‚Äîusing the wrong IP tool wastes resources and may even disclose valuable information."
          }
        }
      },
      {
        id: 25,
        title: "Wearable fitness tracker with health coaching",
        what: "A smartwatch that tracks health metrics and provides AI-powered coaching through a subscription service.",
        description:
          "Your consumer electronics company has built a fitness tracker that differentiates through superior AI coaching that adapts to user behaviour. The hardware is competitive but not breakthrough.",
        imitability:
          "Hardware is similar to competitors. The AI coaching algorithms and user behaviour data are the key differentiators.",
        visibility:
          "Hardware and app interface are visible. AI models and user data are hidden.",
        assets:
          "User base and behavioural data, health coaching content, app ecosystem integrations, brand recognition.",
        context:
          "Wearables market is competitive with dominant incumbents. Subscription revenue is more valuable than hardware sales. User data creates AI advantages.",
        bestChoiceKey: "subscriptionDataEcosystem",
        choices: {
          subscriptionDataEcosystem: {
            label: "AI coaching subscription + user data moat + integrations",
            tools: "Trade secrets, data assets, contracts",
            meta: "You focus on subscriptions, improve AI with data, and integrate deeply.",
            payoff: 4,
            protection: 4,
            cost: 3,
            feedback:
              "The subscription model captures recurring value while user data improves the AI, creating a flywheel. Ecosystem integrations increase user switching costs.",
            concept:
              "In competitive hardware markets, subscription services and data flywheels often create more defensible positions than hardware differentiation."
          },
          patentHardwareFeatures: {
            label: "Patent the smartwatch hardware features and overall product design",
            tools: "Patents, hardware design",
            meta: "You file patents on hardware elements.",
            payoff: 1,
            protection: 2,
            cost: 4,
            feedback:
              "Hardware patents in wearables are easily designed around by well-resourced competitors. You're protecting the least defensible part of your total offering.",
            concept:
              "In commoditising hardware markets, patents on hardware features provide limited protection against resourceful competitors."
          },
          hardwareSalesOnly: {
            label: "Focus on premium hardware sales + skip the subscription service entirely",
            tools: "Hardware premium, retail",
            meta: "You sell at premium without subscriptions.",
            payoff: 0,
            protection: 1,
            cost: 2,
            feedback:
              "Without subscriptions, you compete on hardware alone against larger, better-resourced companies. You also lose the data advantage from engaged subscribers.",
            concept:
              "One-time hardware sales in competitive markets leave you vulnerable to price competition and miss recurring revenue opportunities."
          }
        }
      },
      {
        id: 26,
        title: "Innovative insurance pricing model for gig workers",
        what: "An insurance product that uses real-time work activity data to offer flexible, usage-based coverage for gig economy workers.",
        description:
          "Your insurtech start-up has developed dynamic pricing algorithms that integrate with gig platforms to offer coverage only when workers are actively engaged.",
        imitability:
          "The concept is visible, but the actuarial models and platform integrations are complex and proprietary.",
        visibility:
          "The product and pricing structure are visible. Actuarial models and data partnerships are hidden.",
        assets:
          "Actuarial team, integrations with gig platforms, claims data, regulatory licences.",
        context:
          "Insurance is heavily regulated. Underwriting models are trade secrets. Platform partnerships are essential for data access. Trust matters.",
        bestChoiceKey: "platformPartnershipsData",
        choices: {
          platformPartnershipsData: {
            label: "Platform integrations + proprietary models + regulatory moat",
            tools: "Trade secrets, contracts, regulatory licences, data partnerships",
            meta: "You sign exclusive data deals, develop proprietary models, and leverage regulatory barriers.",
            payoff: 5,
            protection: 5,
            cost: 4,
            feedback:
              "Platform exclusivity provides data no competitor can access. Combined with regulatory barriers and proprietary actuarial models, you create multi-layered protection.",
            concept:
              "In insurtech, exclusive data partnerships plus regulatory barriers create stronger moats than technology alone."
          },
          patentPricingAlgorithm: {
            label: "Patent the dynamic pricing algorithm and pricing methods",
            tools: "Patents, disclosure, technical documentation, filing and legal fees",
            meta: "You file patents on your usage-based pricing methodology seeking legal protection.",
            payoff: 0,
            protection: 1,
            cost: 4,
            feedback:
              "Business method patents are weak and easily circumvented. Disclosure helps competitors understand your approach without providing meaningful protection.",
            concept:
              "Business method patents in financial services are typically weak‚Äîtrade secrets and regulatory barriers are more effective."
          },
          whiteLabel: {
            label: "White-label the technology and sell to traditional insurers",
            tools: "Licensing, partnerships, white-label offering to traditional insurers",
            meta: "You license your technology to established insurers rather than building direct-to-consumer.",
            payoff: 2,
            protection: 2,
            cost: 2,
            feedback:
              "Licensing generates near-term revenue but commoditises your innovation. Insurers may eventually build competing capabilities, and you lose direct customer relationships.",
            concept:
              "Licensing to incumbents can accelerate adoption but risks commoditising your innovation and losing control of customer relationships."
          }
        }
      },
      {
        id: 27,
        title: "Novel enzyme for industrial textile processing",
        what: "A bioengineered enzyme that enables fabric processing at low temperatures, dramatically reducing energy costs for textile manufacturers.",
        description:
          "Your biotech firm has engineered an enzyme through directed evolution that works at room temperature. The enzyme is produced through a proprietary fermentation process.",
        imitability:
          "The enzyme can be characterised, but reproducing it requires knowing the specific genetic modifications and fermentation conditions.",
        visibility:
          "The enzyme's performance is visible. The genetic sequence and production process are hidden.",
        assets:
          "Fermentation expertise, production facility, relationships with textile manufacturers, enzyme development platform.",
        context:
          "Industrial biotech patents are strong. Manufacturing scale matters. B2B customers value reliability and consistency.",
        bestChoiceKey: "patentProcessContracts",
        choices: {
          patentProcessContracts: {
            label: "Patents on enzyme + trade secret fermentation + contracts",
            tools: "Patents, secrecy, contracts",
            meta: "You patent the enzyme, keep production secret, and sign supply agreements.",
            payoff: 5,
            protection: 5,
            cost: 4,
            feedback:
              "Patents protect the enzyme from copying, trade secrets guard the production advantage, and supply contracts lock in customers and provide revenue predictability.",
            concept:
              "Industrial biotech benefits from layering patents (on products) with trade secrets (on processes) and customer contracts."
          },
          publishSequence: {
            label: "Publish enzyme sequence in academic journals for scientific prestige",
            tools: "Publication, reputation, academic journals, scientific credibility, talent attraction",
            meta: "You publish your work to establish scientific credibility, attract research talent, and gain academic prestige.",
            payoff: 1,
            protection: 2,
            cost: 2,
            feedback:
              "Publication establishes credibility but helps competitors replicate your enzyme. You've traded commercial advantage for academic recognition.",
            concept:
              "Academic publication can conflict with commercial interests‚Äîbe strategic about what and when you disclose."
          },
          productionSecrecyOnly: {
            label: "Keep all information as trade secrets + skip patent filing entirely",
            tools: "Secrecy, NDAs, internal controls, staff agreements, manufacturing security",
            meta: "You rely entirely on keeping the enzyme and production process a closely guarded trade secret.",
            payoff: 2,
            protection: 3,
            cost: 2,
            feedback:
              "The enzyme can be characterised by determined competitors. Without patents, you cannot prevent others from using independently developed alternatives.",
            concept:
              "Pure secrecy strategies for products sold in the market are vulnerable to reverse engineering and independent discovery."
          }
        }
      },
      {
        id: 28,
        title: "Modular prefabricated housing system",
        what: "A building system that uses standardised modular components to construct homes 50% faster than traditional methods.",
        description:
          "Your construction start-up has developed a modular system with proprietary interlocking components. The real innovation is in the design software and factory workflow.",
        imitability:
          "The physical components can be measured and copied. The design software and factory process optimisation are harder to replicate.",
        visibility:
          "Finished homes and components are visible. Factory processes and software are hidden.",
        assets:
          "Modular factory, design software, trained installation crews, relationships with developers and local governments.",
        context:
          "Construction is local and relationship-driven. Speed and cost matter to developers. Design rights possible on components.",
        bestChoiceKey: "softwareProcessRelationships",
        choices: {
          softwareProcessRelationships: {
            label: "Proprietary design software + factory secrets + partnerships",
            tools: "Trade secrets, contracts, complementary assets",
            meta: "You protect software/process and build partnerships with developers.",
            payoff: 5,
            protection: 4,
            cost: 3,
            feedback:
              "The real value is in the hidden software and process optimisation. Developer relationships provide market access and important reference projects.",
            concept:
              "In construction, process innovation and customer relationships often matter more than product IP."
          },
          patentComponents: {
            label: "Patent the modular component designs in full technical detail",
            tools: "Patents, design rights, technical documentation, filing requirements, legal fees",
            meta: "You file detailed patents on the physical interlocking mechanisms, seeking comprehensive legal protection.",
            payoff: 2,
            protection: 3,
            cost: 4,
            feedback:
              "Component patents provide some protection but are easily designed around. You've protected the most visible, copyable part while leaving real advantages unexploited.",
            concept:
              "Don't focus protection on the most visible elements when the real value lies in hidden processes and software."
          },
          openSourceDesigns: {
            label: "Open source component designs to drive industry adoption",
            tools: "Open source, ecosystem building, standards development, community engagement",
            meta: "You release component designs openly and try to become the industry standard through adoption.",
            payoff: 1,
            protection: 1,
            cost: 2,
            feedback:
              "Open standards can drive adoption but you've given away your visible differentiation. Without strong software and process advantages, you become just another builder.",
            concept:
              "Open source strategies require strong proprietary advantages elsewhere to capture value."
          }
        }
      },
      {
        id: 29,
        title: "AI music composition tool for content creators",
        what: "A software tool that generates royalty-free background music tailored to video content using AI.",
        description:
          "Your start-up has trained AI models on licensed music to generate original tracks that content creators can use without copyright concerns. The quality rivals human composers.",
        imitability:
          "The concept is known but your models are trained on unique licensed datasets and fine-tuned to content creator needs.",
        visibility:
          "The generated music is audible. The models and training data are hidden.",
        assets:
          "Music licensing agreements for training data, creator community, integrations with video editing platforms.",
        context:
          "AI-generated content is a legal grey area. Copyright protects outputs but not AI methods. Platform integrations drive adoption.",
        bestChoiceKey: "licensingIntegrationsCommunity",
        choices: {
          licensingIntegrationsCommunity: {
            label: "Clean training data licences + platform deals + community",
            tools: "Contracts, community, platform relationships, creator engagement",
            meta: "You ensure clean licensing, integrate with video tools, and build an engaged creator community.",
            payoff: 5,
            protection: 4,
            cost: 3,
            feedback:
              "Clean licensing provides legal safety that competitors may lack. Platform integrations create distribution advantages. Community drives word-of-mouth.",
            concept:
              "In AI content generation, legal clarity on training data plus distribution partnerships often matter more than model sophistication."
          },
          patentAIMethod: {
            label: "Patent the music generation algorithm and AI methods used",
            tools: "Patents, disclosure, technical documentation, filing fees required",
            meta: "You file patents on your AI composition methodology seeking legal protection.",
            payoff: 0,
            protection: 1,
            cost: 4,
            feedback:
              "AI method patents are weak and disclosure helps competitors understand your approach. Your real advantages‚Äîtraining data and platform relationships‚Äîremain unprotected.",
            concept:
              "AI methodology patents are typically weak‚Äîfocus on data advantages and distribution instead."
          },
          copyrightOutputsOnly: {
            label: "Copyright the generated music outputs only + skip other IP",
            tools: "Copyright, content library, pre-generated assets, static catalogue",
            meta: "You build a library of pre-generated tracks and rely on copyright for protection.",
            payoff: 1,
            protection: 2,
            cost: 2,
            feedback:
              "Pre-generated libraries don't scale to individual creator needs. You miss the on-demand generation capability that creators actually want and value most.",
            concept:
              "Static content libraries can't compete with on-demand generation‚Äîprotect the system, not just outputs."
          }
        }
      },
      {
        id: 30,
        title: "Reusable rocket landing system",
        what: "A guidance and propulsion system that enables rocket first stages to land precisely on drone ships for reuse.",
        description:
          "Your space start-up has developed the control algorithms and engine configurations that enable reliable rocket recovery. The technology dramatically reduces launch costs.",
        imitability:
          "The concept is visible (competitors can watch landings), but the control software and engine modifications are highly complex.",
        visibility:
          "Landings are public. Control algorithms and engine specifics are hidden.",
        assets:
          "Aerospace engineering team, flight data from missions, launch contracts with satellite operators and government agencies.",
        context:
          "Aerospace patents are enforceable but limited players exist. Government contracts require proven track records. Mission success data is invaluable.",
        bestChoiceKey: "patentDataContracts",
        choices: {
          patentDataContracts: {
            label: "Patents on key systems + mission data + long-term contracts",
            tools: "Patents, trade secrets, flight data, contracts",
            meta: "You patent hardware, keep algorithms secret, use data, and lock in contracts.",
            payoff: 5,
            protection: 5,
            cost: 5,
            feedback:
              "Aerospace combines strong patent protection with extreme complexity and high switching costs. Flight heritage data and customer contracts create insurmountable barriers.",
            concept:
              "In aerospace, proven flight heritage and customer relationships combine with patents to create formidable, multi-layered protection."
          },
          publishForPrestige: {
            label: "Publish technical details to establish scientific leadership",
            tools: "Publications, reputation",
            meta: "You publish for talent and prestige.",
            payoff: 1,
            protection: 2,
            cost: 2,
            feedback:
              "Publication helps competitors understand your approach. In a market with few players and high stakes, helping potential rivals is strategically questionable.",
            concept:
              "In concentrated markets with high barriers, publication can help competitors more than it helps you."
          },
          tradeSecretOnly: {
            label: "Rely entirely on trade secrets and technical complexity",
            tools: "Secrecy, basic manufacturing assets, internal distribution, factory security",
            meta: "You avoid patent and branding costs and rely on factory secrecy hoping competitors cannot replicate your formula.",
            payoff: 2,
            protection: 3,
            cost: 2,
            feedback:
              "In aerospace, well-resourced competitors or governments may independently develop similar technology. Without patents, you cannot prevent others from using their own solutions.",
            concept:
              "For high-value innovations where independent discovery is likely, patents provide protection that secrecy alone cannot."
          }
        }
      }
    ];

    // --- Game state variables ---
    let currentRound = 0;
    let totalNetProfit = 0;
    let potentialMaxProfit = 0; 
    let correctChoices = 0;
    let totalAnswered = 0;
    let totalProtection = 0; // New: To track cumulative protection score
    let totalCost = 0;       // New: To track cumulative cost score
    let gameConcepts = []; 
    
    // Mini-game trigger variables
    let miniGameTriggerRound = 0; // Which round to show mini-game (3-6)
    let miniGameShown = false;    // Has mini-game been shown this playthrough? 

    // --- DOM Elements ---
    const elements = {
      statRound: document.getElementById("stat-round"),
      statProfit: document.getElementById("stat-profit"),
      statMaxProfit: document.getElementById("stat-max-profit"), 
      statCorrect: document.getElementById("stat-correct"),
      statAnswered: document.getElementById("stat-answered"),
      scenarioTitle: document.getElementById("scenario-title"),
      scenarioWhat: document.getElementById("scenario-what"),
      scenarioDescription: document.getElementById("scenario-description"),
      factImitability: document.getElementById("fact-imitability"),
      factVisibility: document.getElementById("fact-visibility"),
      factAssets: document.getElementById("fact-assets"),
      factContext: document.getElementById("fact-context"),
      choicesContainer: document.getElementById("choices"),
      resultHeading: document.getElementById("result-heading"),
      resultText: document.getElementById("result-text"),
      resultMetrics: document.getElementById("result-metrics"),
      profitText: document.getElementById("profit-text"),
      conceptLink: document.getElementById("concept-link"),
      learningFocus: document.getElementById("learning-focus"),
      focusText: document.getElementById("focus-text"),
      conceptSummary: document.getElementById("concept-summary"),
      conceptList: document.getElementById("concept-list"),
      nextBtn: document.getElementById("next-btn"),
      gameRoot: document.getElementById("game-root"),
      // New enhanced end screen elements
      encouragementBanner: document.getElementById("encouragement-banner"),
      encouragementTitle: document.getElementById("encouragement-title"),
      encouragementMessage: document.getElementById("encouragement-message"),
      finalScores: document.getElementById("final-scores"),
      scoreEfficiency: document.getElementById("score-efficiency"),
      scoreAccuracy: document.getElementById("score-accuracy"),
      strengthsSection: document.getElementById("strengths-section"),
      strengthsList: document.getElementById("strengths-list"),
      growthSection: document.getElementById("growth-section"),
      growthContent: document.getElementById("growth-content"),
      tipsSection: document.getElementById("tips-section"),
      tipsList: document.getElementById("tips-list"),
      replayEncouragement: document.getElementById("replay-encouragement"),
      replayMessage: document.getElementById("replay-message"),
      resourcesSection: document.getElementById("resources-section"),
      creditsSection: document.getElementById("credits-section"),
    };

    // --- Helper Functions ---

    /**
     * Shuffles an array in place (Fisher-Yates algorithm).
     * @param {Array} a - The array to shuffle.
     */
    function shuffle(a) {
      let j, x, i;
      for (i = a.length - 1; i > 0; i--) {
        j = Math.floor(Math.random() * (i + 1));
        x = a[i];
        a[i] = a[j];
        a[j] = x;
      }
      return a;
    }

    // --- Sound Effects for Main Game ---
    const gameSounds = {
      ctx: null,
      init() {
        if (!this.ctx) {
          this.ctx = new (window.AudioContext || window.webkitAudioContext)();
        }
      },
      // Bright rising chime for correct choice
      correct() {
        try {
          this.init();
          const ctx = this.ctx;
          const now = ctx.currentTime;
          [523, 659, 784, 1047].forEach((freq, i) => {
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.type = "sine";
            osc.frequency.value = freq;
            gain.gain.setValueAtTime(0.12, now + i * 0.09);
            gain.gain.exponentialRampToValueAtTime(0.01, now + i * 0.09 + 0.25);
            osc.connect(gain).connect(ctx.destination);
            osc.start(now + i * 0.09);
            osc.stop(now + i * 0.09 + 0.3);
          });
        } catch(e) {}
      },
      // Soft descending tone for sub-optimal choice
      suboptimal() {
        try {
          this.init();
          const ctx = this.ctx;
          const now = ctx.currentTime;
          [400, 350, 300].forEach((freq, i) => {
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.type = "triangle";
            osc.frequency.value = freq;
            gain.gain.setValueAtTime(0.1, now + i * 0.12);
            gain.gain.exponentialRampToValueAtTime(0.01, now + i * 0.12 + 0.2);
            osc.connect(gain).connect(ctx.destination);
            osc.start(now + i * 0.12);
            osc.stop(now + i * 0.12 + 0.25);
          });
        } catch(e) {}
      },
      // Celebratory fanfare for end of game
      fanfare() {
        try {
          this.init();
          const ctx = this.ctx;
          const now = ctx.currentTime;
          // Two-part fanfare: rising arpeggio then a bright chord
          const arpeggio = [523, 659, 784, 1047, 1319];
          arpeggio.forEach((freq, i) => {
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.type = "sine";
            osc.frequency.value = freq;
            gain.gain.setValueAtTime(0.1, now + i * 0.1);
            gain.gain.exponentialRampToValueAtTime(0.01, now + i * 0.1 + 0.35);
            osc.connect(gain).connect(ctx.destination);
            osc.start(now + i * 0.1);
            osc.stop(now + i * 0.1 + 0.4);
          });
          // Final chord
          const chordStart = now + 0.55;
          [523, 659, 784].forEach((freq) => {
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.type = "sine";
            osc.frequency.value = freq;
            gain.gain.setValueAtTime(0.12, chordStart);
            gain.gain.linearRampToValueAtTime(0.0, chordStart + 0.8);
            osc.connect(gain).connect(ctx.destination);
            osc.start(chordStart);
            osc.stop(chordStart + 0.85);
          });
        } catch(e) {}
      },
      // Quick click sound when selecting a button
      click() {
        try {
          this.init();
          const ctx = this.ctx;
          const now = ctx.currentTime;
          const osc = ctx.createOscillator();
          const gain = ctx.createGain();
          osc.type = "sine";
          osc.frequency.setValueAtTime(800, now);
          osc.frequency.exponentialRampToValueAtTime(1000, now + 0.04);
          gain.gain.setValueAtTime(0.08, now);
          gain.gain.exponentialRampToValueAtTime(0.01, now + 0.06);
          osc.connect(gain).connect(ctx.destination);
          osc.start(now);
          osc.stop(now + 0.07);
        } catch(e) {}
      }
    };

    /**
     * Maps performance to the original tiered animal ranks using two ratios.
     * Restored from the original code provided by the user.
     */
     function getRank(totalProfit, correctChoices, maxPossibleProfit) {
      const rounds = MAX_ROUNDS;
      const ratioProfit =
        maxPossibleProfit > 0 ? totalProfit / maxPossibleProfit : 0;
      const ratioCorrect = correctChoices / rounds;

      // Dragon: only if perfect play
      if (
        correctChoices === rounds &&
        totalProfit === maxPossibleProfit
      ) {
        return { animal: "Dragon", emoji: "üê≤", title: "Appropriation Dragon" };
      }

      if (ratioProfit >= 0.8 && ratioCorrect >= 0.8) {
        return { animal: "Shark", emoji: "ü¶à", title: "Appropriation Shark" };
      }

      if (ratioProfit >= 0.6 && ratioCorrect >= 0.6) {
        return { animal: "Fox", emoji: "ü¶ä", title: "Appropriation Fox" };
      }

      if (ratioProfit >= 0.4 && ratioCorrect >= 0.4) {
        return { animal: "Hedgehog", emoji: "ü¶î", title: "Appropriation Hedgehog" };
      }

      return { animal: "Butterfly", emoji: "ü¶ã", title: "Appropriation Butterfly" };
    }


    /**
     * Initializes the game by selecting and shuffling the scenarios.
     */
    function initializeGame() {
      // Shuffle the full list and take the first MAX_ROUNDS for the current game
      scenariosToPlay = shuffle([...allScenarios]).slice(0, MAX_ROUNDS);
      currentRound = 0;
      totalNetProfit = 0;
      potentialMaxProfit = 0; 
      correctChoices = 0;
      totalAnswered = 0;
      totalProtection = 0; // Reset
      totalCost = 0;       // Reset
      gameConcepts = []; 
      
      // Set mini-game to trigger at a random round between 3-6
      miniGameTriggerRound = Math.floor(Math.random() * 4) + 3; // 3, 4, 5, or 6
      miniGameShown = false;

      elements.nextBtn.textContent = "Start Game";
      elements.nextBtn.disabled = false;
      elements.statProfit.textContent = "0";
      elements.statMaxProfit.textContent = "0"; 
      elements.statCorrect.textContent = "0";
      elements.statAnswered.textContent = "0";
      elements.statRound.textContent = "1";

      // Reset to initial state
      elements.resultHeading.textContent = "Make a choice to see the outcome.";
      elements.resultText.textContent = "";
      elements.resultMetrics.textContent = "";
      elements.profitText.textContent = "";
      elements.conceptLink.textContent = "";
      elements.learningFocus.style.display = "none";
      elements.conceptSummary.style.display = "none"; 
      elements.conceptList.innerHTML = "";

      // Start the first round
      loadNextScenario();
    }

    /**
     * Loads the details of the current scenario into the DOM.
     */
    function loadScenario(scenario) {
      elements.scenarioTitle.textContent = scenario.title;
      elements.scenarioWhat.textContent = scenario.what;
      elements.scenarioDescription.textContent = scenario.description;
      elements.factImitability.textContent = scenario.imitability;
      elements.factVisibility.textContent = scenario.visibility;
      elements.factAssets.textContent = scenario.assets;
      elements.factContext.textContent = scenario.context;

      elements.choicesContainer.innerHTML = "";
      // Shuffle the choice keys to randomize display order
      const shuffledKeys = shuffle([...Object.keys(scenario.choices)]);
      shuffledKeys.forEach((key) => {
        const choice = scenario.choices[key];
        const button = document.createElement("button");
        button.className = "choice-btn";
        button.dataset.key = key;
        button.innerHTML = `
          <span class="choice-main">
            ${choice.label}
          </span>
          <span class="choice-tools">${choice.tools}</span>
          <span class="choice-meta">${choice.meta}</span>
        `;
        button.addEventListener("click", () => handleChoice(key));
        elements.choicesContainer.appendChild(button);
      });

      // Clear result and disable next button
      elements.resultHeading.textContent = "Select a strategy...";
      elements.resultHeading.classList.remove("negative");
      elements.resultText.textContent = "";
      elements.resultMetrics.textContent = "";
      elements.profitText.textContent = "";
      elements.conceptLink.textContent = ""; 
      elements.nextBtn.disabled = true;
      elements.nextBtn.textContent = "Next scenario";

      // Hide summary mode if active
      document.body.classList.remove("summary-mode");
      elements.learningFocus.style.display = "none";
      elements.conceptSummary.style.display = "none"; 
    }

    /**
     * Handles a user's choice for the current scenario.
     * @param {string} chosenKey - The key of the chosen strategy.
     */
    function handleChoice(chosenKey) {
      if (!currentScenario) return;

      const chosenChoice = currentScenario.choices[chosenKey];
      const bestChoice = currentScenario.choices[currentScenario.bestChoiceKey];

      // Calculate the maximum possible profit for the current round
      const roundMaxProfit = bestChoice.payoff;

      // Update cumulative max profit (must be done before totalNetProfit is updated)
      potentialMaxProfit += roundMaxProfit; 
      elements.statMaxProfit.textContent = potentialMaxProfit.toString(); // Update the display

      // Update game stats
      totalNetProfit += chosenChoice.payoff;
      totalAnswered++;
      totalProtection += chosenChoice.protection; // Update protection score
      totalCost += chosenChoice.cost;             // Update cost score

      if (chosenKey === currentScenario.bestChoiceKey) {
        correctChoices++;
        gameSounds.correct();
      } else {
        gameSounds.suboptimal();
      }

      // Track scenario choice in Google Analytics
      if (typeof gtag !== 'undefined') {
        gtag('event', 'scenario_choice', {
          'event_category': 'gameplay',
          'event_label': currentScenario.title,
          'scenario_id': currentScenario.id,
          'choice': chosenKey,
          'is_optimal': chosenKey === currentScenario.bestChoiceKey,
          'round': currentRound
        });
      }
      
      // Log the concept for the final summary
      gameConcepts.push(chosenChoice.concept);

      // Update stat bar
      elements.statProfit.textContent = totalNetProfit.toString();
      elements.statCorrect.textContent = correctChoices.toString();
      elements.statAnswered.textContent = totalAnswered.toString();

      // Display result
      elements.resultHeading.textContent = `Round ${currentRound}: ${chosenKey === currentScenario.bestChoiceKey ? "Excellent Choice!" : "Sub-optimal Choice"}`;
      elements.resultHeading.classList.toggle("negative", chosenKey !== currentScenario.bestChoiceKey);
      elements.resultText.textContent = chosenChoice.feedback;
      elements.resultMetrics.innerHTML = `
        <span class="fact-label">Payoff:</span> ${chosenChoice.payoff} (Max possible: ${bestChoice.payoff})<br>
        <span class="fact-label">Protection strength (roughly):</span> ${chosenChoice.protection}/5<br>
        <span class="fact-label">Cost and difficulty:</span> ${chosenChoice.cost}/5
      `;
      elements.profitText.textContent = `Your net profit this round: ${chosenChoice.payoff}. Total net profit: ${totalNetProfit}.`;
      
      // REMOVED: Key concept display here is deleted to avoid repetition.
      // Concept is now only shown in the final summary.

      // Disable all choice buttons and highlight the selected one
      Array.from(elements.choicesContainer.children).forEach(btn => {
        btn.disabled = true;
        btn.classList.remove("selected");
        if (btn.dataset.key === chosenKey) {
          btn.classList.add("selected");
        }
      });

      // Enable the next button and set text based on game progress
      elements.nextBtn.disabled = false;
      if (currentRound === MAX_ROUNDS) {
        elements.nextBtn.textContent = "See Final Summary";
      } else {
        elements.nextBtn.textContent = `Next Scenario (${currentRound}/${MAX_ROUNDS})`;
      }
    }

    /**
     * Loads the next scenario or ends the game.
     * May trigger a mini-game bonus round.
     */
    function loadNextScenario() {
      if (currentRound >= MAX_ROUNDS) {
        endGame();
        return;
      }

      // Check if mini-game should appear (once per game, at the randomly chosen round 3-6)
      if (!miniGameShown && currentRound === miniGameTriggerRound) {
        miniGameShown = true;
        miniGame.show();
        return;
      }

      currentRound++;
      elements.statRound.textContent = currentRound.toString();
      currentScenario = scenariosToPlay[currentRound - 1];
      loadScenario(currentScenario);
    }
    
    /**
     * Actually loads the next round (called after mini-game or directly)
     */
    function proceedToNextRound() {
      currentRound++;
      elements.statRound.textContent = currentRound.toString();
      currentScenario = scenariosToPlay[currentRound - 1];
      loadScenario(currentScenario);
    }

    /**
     * Displays the final summary with enhanced supportive feedback for students.
     */
    function endGame() {
      gameSounds.fanfare();
      document.body.classList.add("summary-mode");

      // Calculate metrics
      const efficiency = potentialMaxProfit > 0 ? (totalNetProfit / potentialMaxProfit) * 100 : 0;
      const avgProtection = totalAnswered > 0 ? (totalProtection / totalAnswered) : 0;
      const avgCost = totalAnswered > 0 ? (totalCost / totalAnswered) : 0;
      const diff = avgCost - avgProtection;
      
      const rank = getRank(totalNetProfit, correctChoices, potentialMaxProfit);
      const isHighPerformer = correctChoices >= 7;
      const isMidPerformer = correctChoices >= 4 && correctChoices < 7;

      // Track game completion in Google Analytics
      if (typeof gtag !== 'undefined') {
        gtag('event', 'game_complete', {
          'event_category': 'engagement',
          'event_label': rank.animal,
          'value': correctChoices,
          'score': totalNetProfit,
          'accuracy': Math.round((correctChoices / MAX_ROUNDS) * 100),
          'efficiency': Math.round(efficiency)
        });
      }

      // --- Main heading with rank ---
      elements.resultHeading.innerHTML = `
        Well Done! You've Completed the Lab! üéâ
        <div class="rank-label">${rank.title} ${rank.emoji}</div>
      `;
      
      // Hide the standard result text for summary mode
      elements.resultText.innerHTML = "";
      elements.resultMetrics.innerHTML = "";
      elements.profitText.textContent = "";
      elements.conceptLink.textContent = "";

      // --- Encouragement Banner ---
      let encourageTitle, encourageMsg;
      if (isHighPerformer) {
        encourageTitle = "Excellent Strategic Thinking! üåü";
        encourageMsg = "You've shown a strong grasp of how to match appropriation strategies to different business contexts. You clearly understand that there's no one-size-fits-all approach‚Äîthe best strategy depends on the specific situation.";
      } else if (isMidPerformer) {
        encourageTitle = "Great Progress! Keep Going! üí™";
        encourageMsg = "You're building solid intuition for appropriation strategy. Every scenario you work through strengthens your understanding. The key concepts are clicking into place‚Äîwith more practice, you'll master this framework.";
      } else {
        encourageTitle = "You're Learning Something Valuable! üå±";
        encourageMsg = "Appropriation strategy is one of the trickiest parts of innovation management‚Äîeven experienced entrepreneurs find it challenging! The fact that you're engaging with these scenarios means you're building important skills. Each game helps you see new patterns.";
        elements.encouragementBanner.classList.add("rank-low");
      }
      elements.encouragementTitle.textContent = encourageTitle;
      elements.encouragementMessage.textContent = encourageMsg;
      elements.encouragementBanner.style.display = "block";

      // --- Score Display ---
      elements.scoreEfficiency.textContent = `${efficiency.toFixed(0)}%`;
      elements.scoreAccuracy.textContent = `${correctChoices}/${MAX_ROUNDS}`;
      elements.finalScores.style.display = "flex";

      // --- Strengths Section (always show positives) ---
      let strengths = [];
      
      // Everyone completed the game - that's an achievement
      strengths.push("You analysed all 10 scenarios and made strategic decisions under uncertainty");
      
      if (correctChoices >= 3) {
        strengths.push(`You identified the best-aligned strategy in ${correctChoices} scenario${correctChoices > 1 ? 's' : ''}`);
      }
      
      if (diff >= -0.5 && diff <= 0.5) {
        strengths.push("You showed good balance between protection strength and cost efficiency");
      } else if (diff < -0.5) {
        strengths.push("You demonstrated cost-consciousness in your strategy choices");
      } else {
        strengths.push("You prioritised strong protection when you saw value at stake");
      }
      
      if (avgProtection >= 3) {
        strengths.push("You understood the importance of building defensive barriers");
      }
      
      if (totalNetProfit > 0) {
        strengths.push("You generated positive net value across your scenarios");
      }

      // Add context-specific strength based on the scenarios they saw
      strengths.push("You practiced applying the same framework to very different industries and contexts");

      elements.strengthsList.innerHTML = strengths.map(s => `<li>${s}</li>`).join('');
      elements.strengthsSection.style.display = "block";

      // --- Growth Section (framed positively) ---
      let growthContent = "";
      
      if (correctChoices >= 8) {
        growthContent = `
          <p>You're performing at a high level! To go even further, consider:</p>
          <p>‚Ä¢ Looking at the few scenarios where you didn't pick the optimal choice‚Äîwhat contextual clues might you have weighted differently?</p>
          <p>‚Ä¢ Thinking about how these strategies would need to adapt as markets and technologies evolve over time.</p>
        `;
      } else if (correctChoices >= 5) {
        growthContent = `
          <p>You're on the right track! Here are some areas to explore as you continue learning:</p>
          <p>‚Ä¢ <strong>Visibility matters:</strong> Ask yourself "What can competitors actually see?" If the innovation is hidden (like a process or algorithm), secrecy becomes more powerful. If it's visible (like a product design), you need IP or other formal protection.</p>
          <p>‚Ä¢ <strong>Complementary assets are key:</strong> Often, the question isn't "who invented it?" but "who controls the assets needed to profit from it?"‚Äîthings like manufacturing, distribution, data, or customer relationships.</p>
        `;
      } else {
        growthContent = `
          <p>Here's a simple framework to guide your thinking in future scenarios:</p>
          <p>‚Ä¢ <strong>Step 1:</strong> Can competitors easily see and copy this innovation? If yes, you'll need formal protection (patents, design rights, trademarks).</p>
          <p>‚Ä¢ <strong>Step 2:</strong> What assets are needed to actually profit from this innovation? Who controls those assets?</p>
          <p>‚Ä¢ <strong>Step 3:</strong> What's the legal and market context? Strong patent system? Relationship-driven industry? Fast-moving market?</p>
          <p>Don't worry if this feels complex‚Äîit takes time to build intuition. Each scenario you work through helps!</p>
        `;
      }
      elements.growthContent.innerHTML = growthContent;
      elements.growthSection.style.display = "block";

      // --- Tips Section ---
      let tips = [];
      
      if (diff > 1) {
        tips.push("Consider lighter-touch tools (secrecy, speed, contracts) when formal IP might be overkill for the situation");
      }
      if (diff < -1) {
        tips.push("In some contexts, stronger formal protection (patents, registered designs) is worth the investment");
      }
      tips.push("Always ask: 'Where is the real value, and who controls the assets needed to capture it?'");
      tips.push("Remember that the best strategy depends on context‚Äîwhat works for pharmaceuticals won't work for restaurants");
      tips.push("Pay attention to what competitors can actually observe versus what stays hidden");
      
      elements.tipsList.innerHTML = tips.map(t => `<li>${t}</li>`).join('');
      elements.tipsSection.style.display = "block";

      // --- Learning Focus (reframed as deepening understanding) ---
      let focusAdvice = "";
      if (isHighPerformer) {
        focusAdvice = "You've demonstrated strong strategic thinking. To deepen your expertise, consider how appropriation strategies need to evolve over time‚Äîwhat works at launch may not work as competitors catch up, technologies change, or markets mature. Think about how firms like Apple, Coca-Cola, or Dyson have adapted their strategies over decades.";
      } else if (isMidPerformer) {
        focusAdvice = "You're developing good instincts! Focus on the interaction between <strong>visibility</strong> (what can be seen), <strong>imitability</strong> (how hard it is to copy), and <strong>complementary assets</strong> (who controls what's needed to profit). These three factors explain most appropriation strategy decisions. Try another round and see if you can spot these patterns more quickly.";
      } else {
        focusAdvice = "The core insight of this framework is that <strong>inventing something valuable isn't enough</strong>‚Äîyou also need to prevent others from copying it AND control the assets needed to actually make money from it. In your next game, try asking three questions for each scenario: (1) What can competitors see? (2) What would they need to copy this? (3) Who controls the key assets? This will help you build intuition for matching strategies to contexts.";
      }
      elements.focusText.innerHTML = focusAdvice;
      elements.learningFocus.style.display = "block";

      // --- Concept Summary ---
      const uniqueConcepts = [...new Set(gameConcepts)];
      if (uniqueConcepts.length > 0) {
        elements.conceptList.innerHTML = uniqueConcepts.map(concept => `<li>${concept}</li>`).join('');
        elements.conceptSummary.style.display = "block";
      }

      // --- Replay Encouragement ---
      let replayMsg;
      if (correctChoices === MAX_ROUNDS) {
        replayMsg = "Perfect score! Want to test yourself with a fresh set of scenarios? Each game draws from 30 different cases, so there's always more to explore.";
      } else if (isHighPerformer) {
        replayMsg = "Great performance! Playing again with different scenarios will help you encounter new industries and contexts. Can you maintain this level across different challenges?";
      } else {
        replayMsg = "Each playthrough features different scenarios from a pool of 30. Playing again lets you practice with fresh contexts and reinforce the patterns you're learning. The more scenarios you see, the stronger your intuition becomes!";
      }
      elements.replayMessage.textContent = replayMsg;
      elements.replayEncouragement.style.display = "block";

      // --- Resources Section ---
      elements.resourcesSection.style.display = "block";

      // --- Credits Section ---
      elements.creditsSection.style.display = "block";

      // --- Play Again Button ---
      elements.nextBtn.textContent = "üéÆ Play Again with New Scenarios";
      elements.nextBtn.disabled = false;
      elements.nextBtn.onclick = () => {
        // Hide all enhanced end screen elements
        elements.encouragementBanner.style.display = "none";
        elements.encouragementBanner.classList.remove("rank-low");
        elements.finalScores.style.display = "none";
        elements.strengthsSection.style.display = "none";
        elements.growthSection.style.display = "none";
        elements.tipsSection.style.display = "none";
        elements.replayEncouragement.style.display = "none";
        elements.resourcesSection.style.display = "none";
        elements.creditsSection.style.display = "none";
        
        // Reset the button's default event handler
        elements.nextBtn.onclick = loadNextScenario;
        initializeGame();
      };
    }

    // --- Info Panel Logic (Existing) ---
    document.querySelectorAll(".info-title, .info-icon").forEach(el => {
      el.addEventListener("click", (e) => {
        const targetId = e.currentTarget.dataset.target;
        const targetPanel = document.getElementById(targetId);
        if (targetPanel) {
          const isVisible = targetPanel.style.display === "block";
          // Close all info panels first
          document.querySelectorAll(".info-content").forEach(panel => {
            if (panel.id !== targetId) {
                panel.style.display = 'none';
            }
          });
          // Toggle the clicked one
          targetPanel.style.display = isVisible ? "none" : "block";
        }
      });
    });

    // ============================================
    // MINI-GAME: Value Drop - Enhanced with Music
    // ============================================
    const miniGame = {
      // DOM Elements
      overlay: document.getElementById("minigame-overlay"),
      arena: document.getElementById("mg-arena"),
      introScreen: document.getElementById("mg-intro-screen"),
      endScreen: document.getElementById("mg-end-screen"),
      fallingProduct: document.getElementById("mg-falling-product"),
      productEmoji: document.getElementById("mg-product-emoji"),
      productLabel: document.getElementById("mg-product-label"),
      timerEl: document.getElementById("mg-timer-val"),
      scoreEl: document.getElementById("mg-score"),
      productsDoneEl: document.getElementById("mg-products-done"),
      startBtn: document.getElementById("mg-start-btn"),
      continueBtn: document.getElementById("mg-continue-btn"),
      finalScoreEl: document.getElementById("mg-final-score"),
      endMessageEl: document.getElementById("mg-end-message"),
      hintBar: document.getElementById("mg-hint-bar"),
      soundToggle: document.getElementById("mg-sound-toggle"),
      columns: document.querySelectorAll(".mg-col"),

      // Audio context for music
      audioCtx: null,
      musicPlaying: false,
      musicNodes: [],
      soundEnabled: true,
      currentBPM: 120,

      // Game State
      isRunning: false,
      score: 0,
      timeLeft: 50,
      timerInterval: null,
      currentProductIndex: 0,
      animationId: null,
      productY: -100,
      currentColumn: 1, // 0-3, start near middle
      fallSpeed: 0.5,
      baseFallSpeed: 0.5,    // Starting fall speed (slow)
      maxFallSpeed: 1.4,     // Final fall speed (fast)
      totalProducts: 6,
      numColumns: 3,

      // Strategy bundles (each column is a combination of mechanisms)
      bundles: [
        { id: "formalIP", label: "Formal IP", mechs: ["patent", "copyright", "trademark"] },
        { id: "secrecyComplexity", label: "Secrecy & Complexity", mechs: ["secrecy", "complexity"] },
        { id: "openNetwork", label: "Open & Network", mechs: ["community"] }
      ],

      // Products with emoji icons and mechanism affinities for bundle scoring
      // Best fit: Formal IP (patent/copyright/trademark), Secrecy & Complexity, or Open & Network (community)
      products: [
        // ‚Äî Best fit: Formal IP ‚Äî
        { name: "Drug Molecule", emoji: "üíä", ideal: ["patent", "trademark"], good: ["contracts", "complexity"], bad: ["community"] },
        { name: "Fashion Brand", emoji: "üëú", ideal: ["trademark", "copyright"], good: ["assets", "contracts"], bad: ["secrecy", "community"] },
        { name: "Blockbuster Film", emoji: "üé¨", ideal: ["copyright", "trademark"], good: ["assets", "contracts"], bad: ["secrecy", "community"] },
        { name: "Patented Engine", emoji: "‚öôÔ∏è", ideal: ["patent", "trademark"], good: ["complexity", "contracts"], bad: ["community"] },
        { name: "Novel Vaccine", emoji: "üíâ", ideal: ["patent", "copyright"], good: ["contracts", "assets"], bad: ["community", "secrecy"] },
        // ‚Äî Best fit: Secrecy & Complexity ‚Äî
        { name: "Jam Recipe", emoji: "ü´ô", ideal: ["secrecy", "complexity"], good: ["trademark", "contracts"], bad: ["patent", "community"] },
        { name: "AI Algorithm", emoji: "ü§ñ", ideal: ["secrecy", "complexity"], good: ["copyright", "contracts"], bad: ["patent", "trademark"] },
        { name: "Chemical Process", emoji: "üß™", ideal: ["secrecy", "complexity"], good: ["patent", "contracts"], bad: ["community", "trademark"] },
        { name: "Trading Strategy", emoji: "üìà", ideal: ["secrecy", "complexity"], good: ["contracts", "assets"], bad: ["patent", "community"] },
        { name: "Chip Design", emoji: "üî¨", ideal: ["secrecy", "complexity"], good: ["patent", "assets"], bad: ["community", "copyright"] },
        // ‚Äî Best fit: Open & Network (community) ‚Äî
        { name: "Education Simulation", emoji: "üéì", ideal: ["community"], good: ["copyright", "trademark"], bad: ["secrecy", "patent"] },
        { name: "Open Source Tool", emoji: "üíª", ideal: ["community"], good: ["copyright", "trademark"], bad: ["patent", "secrecy"] },
        { name: "Fitness Platform", emoji: "üí™", ideal: ["community"], good: ["copyright", "trademark"], bad: ["patent", "secrecy"] },
        { name: "Multiplayer Game", emoji: "üéÆ", ideal: ["community"], good: ["copyright", "trademark"], bad: ["secrecy", "patent"] },
        { name: "Social Network", emoji: "üì±", ideal: ["community"], good: ["trademark", "copyright"], bad: ["secrecy", "patent"] },
      ],

      // Score a product against a bundle: sum points for each mechanism in the bundle
      scoreBundleMatch(product, bundle) {
        let score = 0;
        for (const mech of bundle.mechs) {
          if (product.ideal.includes(mech)) score += 10;
          else if (product.good.includes(mech)) score += 5;
          else if (product.bad.includes(mech)) score -= 5;
          // neutral mechs add 0
        }
        return score;
      },

      // Determine the scoring tier for a product-bundle match
      getBundleTier(product, bundleIndex) {
        const bundle = this.bundles[bundleIndex];
        const score = this.scoreBundleMatch(product, bundle);
        // Find best possible score across all bundles
        const allScores = this.bundles.map(b => this.scoreBundleMatch(product, b));
        const bestScore = Math.max(...allScores);
        if (score === bestScore && score > 10) return "ideal";
        if (score >= 10) return "good";
        if (score <= -5) return "bad";
        return "neutral";
      },

      gameProducts: [],

      // Shuffle helper
      shuffle(arr) {
        const a = [...arr];
        for (let i = a.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [a[i], a[j]] = [a[j], a[i]];
        }
        return a;
      },

      // ==================
      // MUSIC SYSTEM
      // ==================
      initAudio() {
        if (this.audioCtx) return;
        this.audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      },

      startMusic() {
        if (!this.soundEnabled || this.musicPlaying) return;
        this.initAudio();
        this.musicPlaying = true;

        const ctx = this.audioCtx;
        const now = ctx.currentTime;

        // Create a fun, arcade-style background beat
        const playBeat = (startTime) => {
          if (!this.musicPlaying) return;

          // Bass drum
          const bass = ctx.createOscillator();
          const bassGain = ctx.createGain();
          bass.type = "sine";
          bass.frequency.setValueAtTime(80, startTime);
          bass.frequency.exponentialRampToValueAtTime(40, startTime + 0.1);
          bassGain.gain.setValueAtTime(0.4, startTime);
          bassGain.gain.exponentialRampToValueAtTime(0.01, startTime + 0.15);
          bass.connect(bassGain).connect(ctx.destination);
          bass.start(startTime);
          bass.stop(startTime + 0.15);

          // Hi-hat
          const hihat = ctx.createOscillator();
          const hihatGain = ctx.createGain();
          hihat.type = "square";
          hihat.frequency.value = 800;
          hihatGain.gain.setValueAtTime(0.05, startTime + 0.125);
          hihatGain.gain.exponentialRampToValueAtTime(0.01, startTime + 0.175);
          hihat.connect(hihatGain).connect(ctx.destination);
          hihat.start(startTime + 0.125);
          hihat.stop(startTime + 0.2);

          this.musicNodes.push(bass, hihat);
        };

        // Melody notes
        const playMelody = (startTime) => {
          if (!this.musicPlaying) return;
          const notes = [392, 440, 494, 523, 494, 440, 392, 330]; // G4, A4, B4, C5...
          const noteIndex = Math.floor((startTime * 2) % notes.length);
          
          const osc = ctx.createOscillator();
          const gain = ctx.createGain();
          osc.type = "triangle";
          osc.frequency.value = notes[noteIndex];
          gain.gain.setValueAtTime(0.08, startTime);
          gain.gain.exponentialRampToValueAtTime(0.01, startTime + 0.2);
          osc.connect(gain).connect(ctx.destination);
          osc.start(startTime);
          osc.stop(startTime + 0.25);
          this.musicNodes.push(osc);
        };

        // Schedule beats ‚Äî tempo driven by currentBPM
        const bpm = this.currentBPM || 120;
        const beatInterval = 60 / bpm;
        let beatTime = now;

        const scheduleBeats = () => {
          if (!this.musicPlaying) return;
          while (beatTime < ctx.currentTime + 0.5) {
            playBeat(beatTime);
            if (Math.random() > 0.3) playMelody(beatTime);
            beatTime += beatInterval;
          }
          this.beatScheduler = setTimeout(scheduleBeats, 200);
        };
        scheduleBeats();
      },

      stopMusic() {
        this.musicPlaying = false;
        if (this.beatScheduler) clearTimeout(this.beatScheduler);
        this.musicNodes.forEach(node => {
          try { node.stop(); } catch(e) {}
        });
        this.musicNodes = [];
      },

      playSound(type) {
        if (!this.soundEnabled) return;
        this.initAudio();
        const ctx = this.audioCtx;
        const now = ctx.currentTime;

        if (type === "attach") {
          const osc = ctx.createOscillator();
          const gain = ctx.createGain();
          osc.type = "sine";
          osc.frequency.setValueAtTime(600, now);
          osc.frequency.exponentialRampToValueAtTime(900, now + 0.1);
          gain.gain.setValueAtTime(0.15, now);
          gain.gain.exponentialRampToValueAtTime(0.01, now + 0.15);
          osc.connect(gain).connect(ctx.destination);
          osc.start(now);
          osc.stop(now + 0.15);
        } else if (type === "good") {
          [523, 659, 784].forEach((freq, i) => {
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.type = "sine";
            osc.frequency.value = freq;
            gain.gain.setValueAtTime(0.12, now + i * 0.08);
            gain.gain.exponentialRampToValueAtTime(0.01, now + i * 0.08 + 0.2);
            osc.connect(gain).connect(ctx.destination);
            osc.start(now + i * 0.08);
            osc.stop(now + i * 0.08 + 0.25);
          });
        } else if (type === "bad") {
          const osc = ctx.createOscillator();
          const gain = ctx.createGain();
          osc.type = "sawtooth";
          osc.frequency.setValueAtTime(200, now);
          osc.frequency.exponentialRampToValueAtTime(100, now + 0.3);
          gain.gain.setValueAtTime(0.15, now);
          gain.gain.exponentialRampToValueAtTime(0.01, now + 0.3);
          osc.connect(gain).connect(ctx.destination);
          osc.start(now);
          osc.stop(now + 0.35);
        } else if (type === "move") {
          const osc = ctx.createOscillator();
          const gain = ctx.createGain();
          osc.type = "sine";
          osc.frequency.value = 300;
          gain.gain.setValueAtTime(0.05, now);
          gain.gain.exponentialRampToValueAtTime(0.01, now + 0.05);
          osc.connect(gain).connect(ctx.destination);
          osc.start(now);
          osc.stop(now + 0.06);
        }
      },

      toggleSound() {
        this.soundEnabled = !this.soundEnabled;
        this.soundToggle.textContent = this.soundEnabled ? "üîä" : "üîá";
        if (!this.soundEnabled) {
          this.stopMusic();
        } else if (this.isRunning) {
          this.startMusic();
        }
      },

      // ==================
      // GAME LOGIC
      // ==================
      show() {
        this.overlay.classList.add("active");
        this.introScreen.style.display = "flex";
        this.endScreen.style.display = "none";
        this.fallingProduct.style.display = "none";
      },

      hide() {
        this.overlay.classList.remove("active");
        this.stopGame();
        this.stopMusic();
      },

      startGame() {
        this.isRunning = true;
        this.score = 0;
        this.timeLeft = 50;
        this.currentProductIndex = 0;
        this.productY = -80;
        this.currentColumn = 1;

        // Reset fall speed and music tempo
        this.fallSpeed = this.baseFallSpeed;
        this.currentBPM = 120;

        // Shuffle and select products
        this.gameProducts = this.shuffle(this.products).slice(0, this.totalProducts);

        // Update UI
        this.scoreEl.textContent = "0";
        this.timerEl.textContent = this.timeLeft;
        this.timerEl.classList.remove("danger");
        this.productsDoneEl.textContent = `0/${this.totalProducts}`;
        this.introScreen.style.display = "none";
        this.endScreen.style.display = "none";
        this.fallingProduct.style.display = "flex";

        // Clear column highlights
        this.columns.forEach(col => col.classList.remove("active", "flash-ideal", "flash-good", "flash-bad", "flash-neutral"));

        // Load first product
        this.loadProduct();

        // Start music
        this.startMusic();

        // Start timer
        this.timerInterval = setInterval(() => {
          this.timeLeft--;
          this.timerEl.textContent = this.timeLeft;
          if (this.timeLeft <= 10) {
            this.timerEl.classList.add("danger");
          }
          if (this.timeLeft <= 0) {
            this.endGame();
          }
        }, 1000);

        // Start animation loop
        this.animate();
      },

      loadProduct() {
        if (this.currentProductIndex >= this.gameProducts.length) {
          this.endGame();
          return;
        }

        const product = this.gameProducts[this.currentProductIndex];

        // Progressive fall speed
        const progress = this.currentProductIndex / (this.totalProducts - 1);
        this.fallSpeed = this.baseFallSpeed + (this.maxFallSpeed - this.baseFallSpeed) * progress;

        // Speed up music: 120 BPM ‚Üí 180 BPM
        const newBPM = 120 + Math.floor(progress * 60);
        if (newBPM !== this.currentBPM && this.musicPlaying) {
          this.stopMusic();
          this.currentBPM = newBPM;
          this.startMusic();
        } else {
          this.currentBPM = newBPM;
        }

        this.productEmoji.textContent = product.emoji;
        this.productLabel.textContent = product.name;
        this.productY = -80;
        this.currentColumn = 1; // Start near middle
        this.updateProductPosition();
        this.highlightCurrentColumn();

        // Clear column flash states
        this.columns.forEach(col => col.classList.remove("flash-ideal", "flash-good", "flash-bad", "flash-neutral"));

        // Update hint
        this.hintBar.textContent = `${product.name} ‚Äî use ‚Üê ‚Üí or click a bundle`;
      },

      updateProductPosition() {
        const arenaWidth = this.arena.offsetWidth;
        const colWidth = arenaWidth / this.numColumns;
        // Center product over current column
        const leftPos = this.currentColumn * colWidth;
        this.fallingProduct.style.left = leftPos + "px";
        this.fallingProduct.style.top = this.productY + "px";
        this.fallingProduct.style.width = colWidth + "px";
      },

      highlightCurrentColumn() {
        this.columns.forEach((col, i) => {
          col.classList.toggle("active", i === this.currentColumn);
        });
      },

      moveProduct(direction) {
        if (!this.isRunning) return;
        if (direction === "left" && this.currentColumn > 0) {
          this.currentColumn--;
          this.playSound("move");
        } else if (direction === "right" && this.currentColumn < this.numColumns - 1) {
          this.currentColumn++;
          this.playSound("move");
        }
        this.updateProductPosition();
        this.highlightCurrentColumn();
      },

      dropToColumn(colIndex) {
        if (!this.isRunning) return;
        this.currentColumn = colIndex;
        this.updateProductPosition();
        this.highlightCurrentColumn();
        // Hard drop ‚Äî jump to landing zone
        cancelAnimationFrame(this.animationId);
        this.productY = this.arena.offsetHeight - 140;
        this.updateProductPosition();
        this.scoreProduct();
      },

      animate() {
        if (!this.isRunning) return;

        const arenaHeight = this.arena.offsetHeight;
        const landingZone = arenaHeight - 140;

        // Move product down
        this.productY += this.fallSpeed;
        this.updateProductPosition();

        // Check if reached landing zone
        if (this.productY >= landingZone) {
          this.scoreProduct();
        } else {
          this.animationId = requestAnimationFrame(() => this.animate());
        }
      },

      scoreProduct() {
        if (!this.isRunning) return;
        cancelAnimationFrame(this.animationId);

        const product = this.gameProducts[this.currentProductIndex];
        const tier = this.getBundleTier(product, this.currentColumn);

        let points, flashClass, label;
        if (tier === "ideal") {
          points = 30;
          flashClass = "ideal";
          label = "BEST FIT";
          this.playSound("good");
        } else if (tier === "good") {
          points = 15;
          flashClass = "good";
          label = "GOOD FIT";
          this.playSound("attach");
        } else if (tier === "bad") {
          points = -10;
          flashClass = "bad";
          label = "POOR FIT";
          this.playSound("bad");
        } else {
          points = 5;
          flashClass = "neutral";
          label = "OK";
          this.playSound("attach");
        }

        this.score += points;
        this.scoreEl.textContent = this.score;

        // Flash the column
        const col = this.columns[this.currentColumn];
        col.classList.add("flash-" + flashClass);
        setTimeout(() => col.classList.remove("flash-" + flashClass), 800);

        // Show result flash
        this.showResultFlash(flashClass, points, label);

        // Next product
        this.currentProductIndex++;
        this.productsDoneEl.textContent = `${this.currentProductIndex}/${this.totalProducts}`;

        setTimeout(() => {
          if (this.currentProductIndex >= this.gameProducts.length || !this.isRunning) {
            this.endGame();
          } else {
            this.loadProduct();
            this.animate();
          }
        }, 700);
      },

      showResultFlash(type, points, label) {
        const flash = document.createElement("div");
        flash.className = `mg-result-flash ${type}`;
        if (points >= 0) {
          flash.textContent = label + "! +" + points;
        } else {
          flash.textContent = label + "! " + points;
        }
        this.arena.appendChild(flash);
        setTimeout(() => flash.remove(), 900);
      },

      endGame() {
        this.isRunning = false;
        clearInterval(this.timerInterval);
        cancelAnimationFrame(this.animationId);
        this.stopMusic();

        this.fallingProduct.style.display = "none";
        this.endScreen.style.display = "flex";
        this.finalScoreEl.textContent = this.score;

        const maxScore = this.totalProducts * 30;
        const percentage = (this.score / maxScore) * 100;

        if (percentage >= 80) {
          this.endMessageEl.textContent = "Outstanding! You're a strategy master!";
        } else if (percentage >= 60) {
          this.endMessageEl.textContent = "Great work! Strong strategic instincts!";
        } else if (percentage >= 40) {
          this.endMessageEl.textContent = "Good effort! Keep practicing!";
        } else {
          this.endMessageEl.textContent = "Every game builds intuition. Try again!";
        }
      },

      stopGame() {
        this.isRunning = false;
        clearInterval(this.timerInterval);
        cancelAnimationFrame(this.animationId);
      },

      init() {
        this.startBtn.addEventListener("click", () => this.startGame());

        this.continueBtn.addEventListener("click", () => {
          this.hide();
          proceedToNextRound();
        });

        this.soundToggle.addEventListener("click", () => this.toggleSound());

        // Click on columns to hard-drop
        this.columns.forEach((col, index) => {
          col.addEventListener("click", () => this.dropToColumn(index));
        });

        // Keyboard controls
        document.addEventListener("keydown", (e) => {
          if (!this.isRunning) return;
          if (e.key === "ArrowLeft") {
            e.preventDefault();
            this.moveProduct("left");
          } else if (e.key === "ArrowRight") {
            e.preventDefault();
            this.moveProduct("right");
          } else if (e.key === "ArrowDown" || e.key === " ") {
            e.preventDefault();
            // Hard drop into current column
            cancelAnimationFrame(this.animationId);
            this.productY = this.arena.offsetHeight - 120;
            this.updateProductPosition();
            this.scoreProduct();
          }
        });

        // Touch support
        this.arena.addEventListener("touchstart", (e) => {
          if (!this.isRunning) return;
          const touch = e.touches[0];
          const rect = this.arena.getBoundingClientRect();
          const x = touch.clientX - rect.left;
          const y = touch.clientY - rect.top;
          const colWidth = rect.width / this.numColumns;

          // If tapping on column zone (bottom 90px), hard-drop to that column
          if (y > rect.height - 90) {
            const colIndex = Math.min(Math.floor(x / colWidth), this.numColumns - 1);
            this.dropToColumn(colIndex);
            e.preventDefault();
            return;
          }

          // Otherwise tap left/right half to move
          if (x < rect.width / 2) {
            this.moveProduct("left");
          } else {
            this.moveProduct("right");
          }
          e.preventDefault();
        }, { passive: false });
      }
    };

    // Initialize mini-game
    miniGame.init();

    // --- Event Listeners ---    // --- Event Listeners ---
    elements.nextBtn.addEventListener("click", loadNextScenario);

    // --- Intro Screen Logic ---
    const introScreen = document.getElementById("intro-screen");
    const startBtn = document.getElementById("start-btn");

    function showGame() {
      introScreen.style.display = "none";
      elements.gameRoot.classList.remove("hidden");
      initializeGame();
      
      // Track game start in Google Analytics
      if (typeof gtag !== 'undefined') {
        gtag('event', 'game_start', {
          'event_category': 'engagement',
          'event_label': 'Appropriation Strategy Lab'
        });
      }
    }

    startBtn.addEventListener("click", showGame);

    // --- Game Start (show intro first) ---
    document.addEventListener("DOMContentLoaded", () => {
      // Show cookie banner if user hasn't made a choice yet
      var consent = localStorage.getItem('ga_consent');
      if (!consent) {
        document.getElementById('cookie-banner').style.display = 'flex';
      }
      // Initialise consent status text and change-preference links
      updateConsentLinks();
    });
  </script>
</body>
</html>